---
phase: 16-realtime-visualizations
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [
  src/components/views/NetworkView.tsx,
  src/components/views/D3GridView.tsx,
  src/components/views/D3ListView.tsx,
  src/hooks/useD3Performance.ts,
  src/examples/LiveVisualizationExample.tsx
]
autonomous: true

must_haves:
  truths:
    - "D3 visualizations show real-time data updates"
    - "NetworkView displays live Apple Notes connections"
    - "GridView updates automatically when data changes"
    - "ListView refreshes with <100ms latency"
    - "Smooth transitions animate data changes"
  artifacts:
    - path: "src/components/views/NetworkView.tsx"
      provides: "Live data NetworkView with useLiveData integration"
      exports: ["NetworkView"]
      min_lines: 450
    - path: "src/components/views/D3GridView.tsx"
      provides: "Real-time grid visualization"
      exports: ["D3GridView"]
      min_lines: 300
    - path: "src/hooks/useD3Performance.ts"
      provides: "D3 rendering performance monitoring"
      exports: ["useD3Performance"]
      min_lines: 100
  key_links:
    - from: "src/components/views/NetworkView.tsx"
      to: "useLiveData"
      via: "import and useEffect"
      pattern: "useLiveData.*nodes.*edges"
    - from: "src/hooks/useD3Performance.ts"
      to: "DataFlowMonitor"
      via: "performance integration"
      pattern: "performance\\..*fps"
---

<objective>
Integrate live data subscriptions with D3 visualizations to enable real-time updates with smooth animations.

Purpose: Transform existing D3 views from static data displays into dynamic real-time visualizations that respond instantly to data changes while maintaining visual continuity through smooth transitions.
Output: Live-data-powered D3 views ready for production use with 6,891+ nodes
</objective>

<execution_context>
@/Users/mshaler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mshaler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/phases/15-live-data-integration/15-01-SUMMARY.md
@src/hooks/useLiveData.tsx
@src/components/views/NetworkView.tsx
@src/components/views/D3GridView.tsx
@src/components/views/D3ListView.tsx
@src/hooks/useD3.ts
</context>

<tasks>

<task type="auto">
  <name>Convert NetworkView to Live Data</name>
  <files>src/components/views/NetworkView.tsx</files>
  <action>
    Replace useSQLiteQuery with useLiveData in NetworkView component:
    - Import useLiveData and replace static data fetching
    - Add live subscription for both nodes and edges with performance options
    - Implement smooth D3 transitions for data updates using enter/update/exit pattern
    - Add hash-based change detection to minimize unnecessary re-renders
    - Integrate performance tracking with existing graph analytics
    - Preserve all existing functionality (zoom, drag, selection, suggestions)
    - Add throttling (100ms) to prevent excessive updates during rapid changes

    Use performanceOptions: { trackPerformance: true, throttleMs: 100 }
    Key change: Replace edge query with live subscription that auto-refreshes
  </action>
  <verify>npm run type-check passes, NetworkView renders with live updates</verify>
  <done>NetworkView subscribes to live data and smoothly animates node/edge changes</done>
</task>

<task type="auto">
  <name>Enhance D3GridView and D3ListView with Live Data</name>
  <files>src/components/views/D3GridView.tsx, src/components/views/D3ListView.tsx</files>
  <action>
    Convert both D3 views to use live data subscriptions:

    D3GridView changes:
    - Replace mock/static data hooks with useLiveData for nodes query
    - Add smooth transitions for grid cell updates using D3 transition chains
    - Implement efficient rendering for large datasets (6,891+ nodes)
    - Add virtual scrolling preparation (calculate visible bounds)
    - Use throttled updates (100ms) to maintain 60fps during rapid changes

    D3ListView changes:
    - Convert to useLiveData with nodes + search result subscription
    - Add smooth list item animations for add/remove/update operations
    - Implement incremental rendering for performance with large lists
    - Add automatic scroll position preservation during updates
    - Integrate with live search/filtering capabilities

    Both: Add error handling with graceful degradation to prevent visualization breakage
  </action>
  <verify>Both views render smoothly with live data and maintain performance</verify>
  <done>D3GridView and D3ListView use live subscriptions with smooth transitions</done>
</task>

<task type="auto">
  <name>Create D3 Performance Monitoring Hook</name>
  <files>src/hooks/useD3Performance.ts, src/examples/LiveVisualizationExample.tsx</files>
  <action>
    Create useD3Performance hook for visualization-specific performance tracking:

    useD3Performance features:
    - Frame rate monitoring during D3 updates (target: 60fps)
    - Render time tracking for complex visualizations
    - Memory usage monitoring for large datasets
    - Integration with existing DataFlowMonitor component
    - Automatic performance degradation warnings
    - Configurable thresholds for performance alerts

    Hook interface:
    ```typescript
    interface D3PerformanceMetrics {
      currentFps: number;
      averageFps: number;
      renderTime: number;
      memoryUsage: number;
      nodeCount: number;
      isPerformant: boolean;
    }

    export function useD3Performance(target?: SVGElement): D3PerformanceMetrics
    ```

    LiveVisualizationExample:
    - Create comprehensive example showcasing live D3 integration
    - Include NetworkView, GridView, ListView in tabs
    - Add performance monitoring overlay
    - Demonstrate real-time filtering with live data
    - Include controls for stress testing (data size, update frequency)
  </action>
  <verify>Hook provides accurate performance metrics, example renders without errors</verify>
  <done>useD3Performance tracks FPS and integrates with DataFlowMonitor</done>
</task>

</tasks>

<verification>
- NetworkView shows live node/edge updates with smooth transitions
- D3GridView and D3ListView render real-time data changes seamlessly
- useD3Performance provides accurate FPS and render time metrics
- LiveVisualizationExample demonstrates full live integration
- All views maintain performance with 6,891+ nodes
</verification>

<success_criteria>
- D3 visualizations subscribe to live data and update automatically
- Smooth transitions animate data changes without jarring updates
- Performance monitoring tracks 60fps target during rendering
- Views handle large datasets efficiently with proper throttling
- Error handling prevents visualization breakage during data issues
</success_criteria>

<output>
After completion, create `.planning/phases/16-realtime-visualizations/16-01-SUMMARY.md`
</output>