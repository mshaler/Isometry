<!DOCTYPE html>
<html>
<head>
    <title>Janus Density Model - Revolutionary SuperGrid Control</title>
    <style>
        :root {
            --surface-color: #ffffff;
            --surface-secondary: #f8fafc;
            --border-color: #e2e8f0;
            --border-light: #f1f5f9;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --accent-color: #3b82f6;
            --accent-text: #ffffff;
            --primary-color: #1d4ed8;
            --primary-text: #ffffff;
            --secondary-color: #7c3aed;
            --secondary-text: #ffffff;
            --hover-color: #f3f4f6;
            --active-color: #e5e7eb;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
        }

        body {
            margin: 0;
            padding: 20px;
            font-family: system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            padding: 24px;
            background: linear-gradient(135deg, #1d4ed8 0%, #7c3aed 100%);
            color: white;
        }

        .header h1 {
            margin: 0 0 8px 0;
            font-size: 2rem;
            font-weight: 700;
        }

        .header p {
            margin: 0;
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .main-content {
            display: grid;
            grid-template-areas:
                "controls controls"
                "density supergrid";
            grid-template-columns: 400px 1fr;
            grid-template-rows: auto 1fr;
            height: 800px;
        }

        .controls-section {
            grid-area: controls;
            padding: 20px;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            align-items: center;
        }

        .density-panel {
            grid-area: density;
            padding: 20px;
            background: white;
            border-right: 1px solid #e2e8f0;
            overflow-y: auto;
        }

        .supergrid-area {
            grid-area: supergrid;
            padding: 20px;
            background: white;
            overflow: auto;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-group label {
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
        }

        select, button {
            padding: 6px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            font-size: 0.875rem;
            cursor: pointer;
        }

        button {
            background: #3b82f6;
            color: white;
            border-color: #2563eb;
            font-weight: 500;
        }

        button:hover {
            background: #2563eb;
        }

        .status {
            padding: 12px 16px;
            background: #dbeafe;
            border-left: 4px solid #3b82f6;
            margin: 16px 20px;
            border-radius: 0 6px 6px 0;
            font-weight: 500;
        }

        /* Janus Density Controls */
        .janus-controls {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 16px;
            font-size: 0.875rem;
        }

        .janus-section {
            background: white;
            border: 1px solid #f1f5f9;
            border-radius: 6px;
            padding: 12px;
        }

        .janus-title {
            margin: 0 0 12px 0;
            font-size: 1rem;
            font-weight: 600;
            color: #1f2937;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .janus-quadrant {
            background: #3b82f6;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 500;
            text-align: center;
            margin-bottom: 16px;
            animation: quadrantPulse 2s infinite ease-in-out;
        }

        @keyframes quadrantPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        .janus-label {
            display: flex;
            flex-direction: column;
            gap: 8px;
            font-weight: 500;
            color: #1f2937;
            margin-bottom: 12px;
        }

        .janus-label > span {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .janus-toggle {
            display: flex;
            background: #f1f5f9;
            border-radius: 20px;
            padding: 2px;
            border: none;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .janus-toggle-option {
            flex: 1;
            padding: 8px 16px;
            border-radius: 18px;
            text-align: center;
            font-size: 0.8rem;
            font-weight: 500;
            transition: all 0.3s ease;
            background: transparent;
            color: #6b7280;
        }

        .janus-toggle.active-sparse .janus-toggle-option:first-child,
        .janus-toggle.active-dense .janus-toggle-option:last-child {
            background: #1d4ed8;
            color: white;
            box-shadow: 0 2px 8px rgba(29, 78, 216, 0.3);
        }

        .janus-toggle.active-leaf .janus-toggle-option:first-child,
        .janus-toggle.active-rolled .janus-toggle-option:last-child {
            background: #7c3aed;
            color: white;
            box-shadow: 0 2px 8px rgba(124, 58, 237, 0.3);
        }

        .janus-description {
            font-size: 0.75rem;
            color: #6b7280;
            font-style: italic;
            margin-top: 4px;
        }

        .janus-slider {
            width: 100%;
            height: 8px;
            background: linear-gradient(to right, #ef4444 0%, #f59e0b 33%, #10b981 66%, #3b82f6 100%);
            border-radius: 4px;
            outline: none;
            appearance: none;
            cursor: pointer;
            margin: 8px 0;
        }

        .janus-slider::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            background: white;
            border: 3px solid #3b82f6;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .janus-zoom-value {
            font-weight: 600;
            color: #3b82f6;
            font-size: 0.9rem;
        }

        .janus-zoom-labels {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-top: 12px;
        }

        .janus-zoom-axis {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.8rem;
        }

        .janus-axis-name {
            font-weight: 500;
            color: #1f2937;
            min-width: 70px;
        }

        .janus-level-name {
            color: #6b7280;
            min-width: 90px;
        }

        .janus-level-samples {
            background: #f8fafc;
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.75rem;
            color: #6b7280;
        }

        .janus-pan-controls {
            display: grid;
            grid-template-areas:
                ". up ."
                "left center right"
                ". down .";
            gap: 4px;
            justify-items: center;
            max-width: 120px;
            margin: 0 auto;
        }

        .janus-pan-controls button {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            width: 36px;
            height: 36px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            font-size: 1.1rem;
        }

        .janus-pan-controls button:hover {
            background: #f3f4f6;
            border-color: #3b82f6;
            transform: translateY(-1px);
        }

        .janus-pan-controls button:nth-child(1) { grid-area: up; }
        .janus-pan-controls button:nth-child(2) { grid-area: left; }
        .janus-pan-controls button:nth-child(3) { grid-area: center; background: #3b82f6; color: white; }
        .janus-pan-controls button:nth-child(4) { grid-area: right; }
        .janus-pan-controls button:nth-child(5) { grid-area: down; }

        .janus-pan-position {
            text-align: center;
            font-size: 0.8rem;
            color: #6b7280;
            font-family: 'Courier New', monospace;
            margin-top: 8px;
        }

        .janus-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            padding: 16px;
            background: white;
            border: 1px solid #f1f5f9;
            border-radius: 6px;
        }

        .janus-stat {
            display: flex;
            flex-direction: column;
            gap: 4px;
            text-align: center;
        }

        .janus-stat-label {
            font-size: 0.7rem;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 500;
        }

        .janus-stat-value {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1f2937;
            font-family: 'Courier New', monospace;
        }

        /* Grid Display */
        .demo-grid {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            min-height: 400px;
            display: flex;
            flex-direction: column;
        }

        .demo-grid-header {
            padding: 16px;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
            border-radius: 8px 8px 0 0;
        }

        .demo-grid-content {
            padding: 16px;
            flex: 1;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.6;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-areas:
                    "controls"
                    "density"
                    "supergrid";
                grid-template-columns: 1fr;
                grid-template-rows: auto auto 1fr;
            }

            .density-panel {
                border-right: none;
                border-bottom: 1px solid #e2e8f0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåä Janus Density Model</h1>
            <p>Revolutionary four-quadrant control system for SuperGrid polymorphic data projection</p>
        </div>

        <div class="controls-section">
            <div class="control-group">
                <label>Mode:</label>
                <select id="modeSelect">
                    <option value="gallery">Gallery (0 axes)</option>
                    <option value="list">List (1 axis)</option>
                    <option value="kanban">Kanban (1 facet)</option>
                    <option value="grid">Grid (2 axes)</option>
                    <option value="supergrid" selected>SuperGrid (n axes)</option>
                </select>
            </div>

            <div class="control-group">
                <label>X Axis:</label>
                <select id="xAxisSelect">
                    <option value="">None</option>
                    <option value="category-folder" selected>Category ‚Üí Folder</option>
                    <option value="time-year">Time ‚Üí Year</option>
                    <option value="alphabet-name">Alphabet ‚Üí Name</option>
                    <option value="hierarchy-priority">Hierarchy ‚Üí Priority</option>
                </select>
            </div>

            <div class="control-group">
                <label>Y Axis:</label>
                <select id="yAxisSelect">
                    <option value="">None</option>
                    <option value="time-month" selected>Time ‚Üí Month</option>
                    <option value="category-status">Category ‚Üí Status</option>
                    <option value="hierarchy-importance">Hierarchy ‚Üí Importance</option>
                </select>
            </div>

            <button onclick="generateMoreData()">üìä Generate More Data</button>
            <button onclick="applyJanusSettings()">üéØ Apply Janus</button>
        </div>

        <div id="status" class="status">
            Initializing Janus Density Model with SuperGrid...
        </div>

        <div class="main-content">
            <!-- Janus Density Controls -->
            <div class="density-panel">
                <div class="janus-controls">
                    <div class="janus-section">
                        <h3 class="janus-title">üéØ Janus Density Control</h3>
                        <div class="janus-quadrant" id="currentQuadrant">Sparse + Leaf: Full Cartesian with finest detail</div>
                    </div>

                    <!-- Extent Control (Pan) -->
                    <div class="janus-section">
                        <div class="janus-label">
                            <span>üìç Extent (Pan)</span>
                        </div>
                        <button class="janus-toggle active-sparse" id="extentToggle" onclick="toggleExtent()">
                            <span class="janus-toggle-option">Sparse</span>
                            <span class="janus-toggle-option">Dense</span>
                        </button>
                        <div class="janus-description" id="extentDescription">
                            Show all possible cells (including empty)
                        </div>
                    </div>

                    <!-- Value Control (Zoom) -->
                    <div class="janus-section">
                        <div class="janus-label">
                            <span>üîç Value (Zoom)</span>
                        </div>
                        <button class="janus-toggle active-leaf" id="valueToggle" onclick="toggleValue()">
                            <span class="janus-toggle-option">Leaf</span>
                            <span class="janus-toggle-option">Rolled</span>
                        </button>
                        <div class="janus-description" id="valueDescription">
                            Finest granularity (individual values)
                        </div>
                    </div>

                    <!-- Zoom Level Control -->
                    <div class="janus-section">
                        <div class="janus-label">
                            <span>üìè Zoom Level <span class="janus-zoom-value" id="zoomValue">3/3</span></span>
                        </div>
                        <input type="range" min="0" max="3" value="3" class="janus-slider" id="zoomSlider" oninput="updateZoom(this.value)">

                        <div class="janus-zoom-labels" id="zoomLabels">
                            <div class="janus-zoom-axis">
                                <span class="janus-axis-name">category:</span>
                                <span class="janus-level-name">Tag</span>
                                <code class="janus-level-samples">React, TypeScript...</code>
                            </div>
                            <div class="janus-zoom-axis">
                                <span class="janus-axis-name">time:</span>
                                <span class="janus-level-name">Month</span>
                                <code class="janus-level-samples">Jan 2024, Feb 2024...</code>
                            </div>
                        </div>
                    </div>

                    <!-- Pan Controls -->
                    <div class="janus-section">
                        <div class="janus-label">üó∫Ô∏è Pan Offset</div>
                        <div class="janus-pan-controls">
                            <button onclick="pan(0, -10)">‚¨ÜÔ∏è</button>
                            <button onclick="pan(-10, 0)">‚¨ÖÔ∏è</button>
                            <button onclick="resetPan()">üéØ</button>
                            <button onclick="pan(10, 0)">‚û°Ô∏è</button>
                            <button onclick="pan(0, 10)">‚¨áÔ∏è</button>
                        </div>
                        <div class="janus-pan-position" id="panPosition">(0, 0)</div>
                    </div>
                </div>

                <!-- Density Statistics -->
                <div class="janus-stats" id="janusStats">
                    <div class="janus-stat">
                        <span class="janus-stat-label">Total Cells</span>
                        <span class="janus-stat-value" id="totalCells">1,200</span>
                    </div>
                    <div class="janus-stat">
                        <span class="janus-stat-label">Populated</span>
                        <span class="janus-stat-value" id="populatedCells">89</span>
                    </div>
                    <div class="janus-stat">
                        <span class="janus-stat-label">Sparsity</span>
                        <span class="janus-stat-value" id="sparsityRatio">7.4%</span>
                    </div>
                    <div class="janus-stat">
                        <span class="janus-stat-label">Compression</span>
                        <span class="janus-stat-value" id="compressionRatio">1.0x</span>
                    </div>
                </div>
            </div>

            <!-- SuperGrid Display -->
            <div class="supergrid-area">
                <div class="demo-grid">
                    <div class="demo-grid-header">
                        <h3 style="margin: 0 0 8px 0;">üåä Janus SuperGrid Live Demo</h3>
                        <p style="margin: 0; color: #6b7280;">Real-time density control with orthogonal Pan √ó Zoom</p>
                    </div>
                    <div class="demo-grid-content" id="gridDisplay">
                        <div style="text-align: center; color: #6b7280; margin-top: 100px;">
                            <div style="font-size: 3rem; margin-bottom: 16px;">üéØ</div>
                            <div>Janus Density Model Loading...</div>
                            <div style="font-size: 0.875rem; margin-top: 8px;">Preparing four-quadrant control system</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Janus Density State
        let janusState = {
            extentMode: 'sparse',  // sparse | dense
            valueMode: 'leaf',     // leaf | rolled
            zoomLevel: 3,          // 0-3
            panOffset: { x: 0, y: 0 }
        };

        let nodesData = [];

        // Generate sample data
        function generateSampleData(count = 200) {
            const folders = ['Work', 'Personal', 'Projects', 'Archive', 'Ideas', 'Research', 'Design', 'Development'];
            const statuses = ['Active', 'Complete', 'Pending', 'Archived', 'Draft', 'Review'];
            const priorities = [0, 1, 2, 3];
            const importance = [0, 1, 2, 3];

            nodesData = [];
            for (let i = 0; i < count; i++) {
                const date = new Date(Date.now() - Math.random() * 365 * 24 * 60 * 60 * 1000);
                nodesData.push({
                    id: `node-${i}`,
                    name: `Item ${i + 1}`,
                    content: `Content for item ${i + 1}`,
                    summary: `Summary ${i + 1}`,
                    folder: folders[Math.floor(Math.random() * folders.length)],
                    status: statuses[Math.floor(Math.random() * statuses.length)],
                    priority: priorities[Math.floor(Math.random() * priorities.length)],
                    importance: importance[Math.floor(Math.random() * importance.length)],
                    created_at: date.toISOString()
                });
            }
            return nodesData;
        }

        // Toggle functions
        function toggleExtent() {
            janusState.extentMode = janusState.extentMode === 'sparse' ? 'dense' : 'sparse';
            updateJanusUI();
            renderGrid();
        }

        function toggleValue() {
            janusState.valueMode = janusState.valueMode === 'leaf' ? 'rolled' : 'leaf';
            updateJanusUI();
            renderGrid();
        }

        function updateZoom(value) {
            janusState.zoomLevel = parseInt(value);
            updateJanusUI();
            renderGrid();
        }

        function pan(deltaX, deltaY) {
            janusState.panOffset.x += deltaX;
            janusState.panOffset.y += deltaY;
            updateJanusUI();
            renderGrid();
        }

        function resetPan() {
            janusState.panOffset = { x: 0, y: 0 };
            updateJanusUI();
            renderGrid();
        }

        function generateMoreData() {
            const currentCount = nodesData.length;
            generateSampleData(currentCount + 50);
            document.getElementById('status').textContent = `‚úÖ Generated ${nodesData.length} nodes for Janus density testing`;
            renderGrid();
        }

        function applyJanusSettings() {
            renderGrid();
            document.getElementById('status').textContent = `üéØ Janus settings applied: ${janusState.extentMode} + ${janusState.valueMode}, zoom ${janusState.zoomLevel}`;
        }

        // Update Janus UI
        function updateJanusUI() {
            // Update quadrant display
            const extent = janusState.extentMode === 'sparse' ? 'Sparse' : 'Dense';
            const value = janusState.valueMode === 'leaf' ? 'Leaf' : 'Rolled';

            const descriptions = {
                'Sparse + Leaf': 'Full Cartesian view with finest detail',
                'Dense + Leaf': 'Populated-only view with finest detail',
                'Sparse + Rolled': 'Full Cartesian view with aggregated data',
                'Dense + Rolled': 'Populated-only view with aggregated data'
            };

            const quadrantKey = `${extent} + ${value}`;
            document.getElementById('currentQuadrant').textContent = `${quadrantKey}: ${descriptions[quadrantKey]}`;

            // Update toggle buttons
            const extentToggle = document.getElementById('extentToggle');
            extentToggle.className = `janus-toggle active-${janusState.extentMode}`;

            const valueToggle = document.getElementById('valueToggle');
            valueToggle.className = `janus-toggle active-${janusState.valueMode}`;

            // Update extent description
            document.getElementById('extentDescription').textContent =
                janusState.extentMode === 'sparse'
                    ? 'Show all possible cells (including empty)'
                    : 'Show only populated cells';

            // Update value description
            document.getElementById('valueDescription').textContent =
                janusState.valueMode === 'leaf'
                    ? 'Finest granularity (individual values)'
                    : 'Aggregated granularity (grouped values)';

            // Update zoom display
            document.getElementById('zoomValue').textContent = `${janusState.zoomLevel}/3`;
            document.getElementById('zoomSlider').value = janusState.zoomLevel;

            // Update pan position
            document.getElementById('panPosition').textContent = `(${janusState.panOffset.x}, ${janusState.panOffset.y})`;

            // Update statistics
            updateDensityStats();
        }

        function updateDensityStats() {
            if (!nodesData.length) return;

            const xAxis = document.getElementById('xAxisSelect').value;
            const yAxis = document.getElementById('yAxisSelect').value;

            // Calculate grid dimensions based on current settings
            let totalPossibleCells = 1;
            let populatedCells = 1;

            if (xAxis) {
                const xValues = [...new Set(nodesData.map(n => extractNodeValue(n, xAxis)))];
                totalPossibleCells *= janusState.valueMode === 'rolled' ? Math.ceil(xValues.length / 2) : xValues.length;
            }

            if (yAxis) {
                const yValues = [...new Set(nodesData.map(n => extractNodeValue(n, yAxis)))];
                totalPossibleCells *= janusState.valueMode === 'rolled' ? Math.ceil(yValues.length / 2) : yValues.length;
            }

            // Calculate actual populated cells
            const cellMap = new Map();
            nodesData.forEach(node => {
                const xVal = xAxis ? extractNodeValue(node, xAxis) : 'default';
                const yVal = yAxis ? extractNodeValue(node, yAxis) : 'default';
                const cellKey = `${yVal}:${xVal}`;
                if (!cellMap.has(cellKey)) cellMap.set(cellKey, []);
                cellMap.get(cellKey).push(node);
            });
            populatedCells = cellMap.size;

            if (janusState.extentMode === 'dense') {
                totalPossibleCells = populatedCells; // Only show populated
            }

            const sparsityRatio = (populatedCells / totalPossibleCells) * 100;
            const compressionRatio = janusState.valueMode === 'rolled' ? 2.5 : 1.0;

            document.getElementById('totalCells').textContent = totalPossibleCells.toLocaleString();
            document.getElementById('populatedCells').textContent = populatedCells.toLocaleString();
            document.getElementById('sparsityRatio').textContent = `${sparsityRatio.toFixed(1)}%`;
            document.getElementById('compressionRatio').textContent = `${compressionRatio.toFixed(1)}x`;
        }

        function extractNodeValue(node, axisMapping) {
            const [axis, facet] = axisMapping.split('-');

            switch (axis) {
                case 'category':
                    return facet === 'folder' ? node.folder : node.status;
                case 'time':
                    const date = new Date(node.created_at);
                    if (facet === 'year') return date.getFullYear().toString();
                    if (facet === 'month') return date.toLocaleDateString('en-US', { month: 'long' });
                    return date.getFullYear().toString();
                case 'alphabet':
                    return node.name.charAt(0).toUpperCase();
                case 'hierarchy':
                    const val = facet === 'priority' ? node.priority : node.importance;
                    if (val >= 3) return 'High';
                    if (val >= 2) return 'Medium';
                    if (val >= 1) return 'Low';
                    return 'None';
                default:
                    return 'Unknown';
            }
        }

        function renderGrid() {
            const mode = document.getElementById('modeSelect').value;
            const xAxis = document.getElementById('xAxisSelect').value;
            const yAxis = document.getElementById('yAxisSelect').value;

            let html = `
                <div style="background: #f8fafc; padding: 12px; border-radius: 6px; margin-bottom: 16px;">
                    <strong>üåä Janus Density Model Active</strong><br>
                    Mode: ${mode} |
                    Extent: ${janusState.extentMode.toUpperCase()} |
                    Value: ${janusState.valueMode.toUpperCase()} |
                    Zoom: ${janusState.zoomLevel}/3 |
                    Pan: (${janusState.panOffset.x}, ${janusState.panOffset.y})<br>
                    X: ${xAxis || 'None'} | Y: ${yAxis || 'None'} | Nodes: ${nodesData.length}
                </div>
            `;

            if (janusState.extentMode === 'sparse' && janusState.valueMode === 'leaf') {
                html += `
                    <div style="background: #dbeafe; padding: 16px; border-radius: 8px; border-left: 4px solid #3b82f6;">
                        <strong>üìç SPARSE + üîç LEAF Quadrant</strong><br>
                        Full Cartesian view with finest detail - showing ALL possible cells including empty ones.
                        Maximum information density with complete spatial context.
                    </div>
                `;
            } else if (janusState.extentMode === 'dense' && janusState.valueMode === 'leaf') {
                html += `
                    <div style="background: #dcfce7; padding: 16px; border-radius: 8px; border-left: 4px solid #10b981;">
                        <strong>üì¶ DENSE + üîç LEAF Quadrant</strong><br>
                        Populated-only view with finest detail - hiding empty cells for focused data exploration.
                        Compact layout with maximum detail where data exists.
                    </div>
                `;
            } else if (janusState.extentMode === 'sparse' && janusState.valueMode === 'rolled') {
                html += `
                    <div style="background: #fef3c7; padding: 16px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                        <strong>üìç SPARSE + üìä ROLLED Quadrant</strong><br>
                        Full Cartesian view with aggregated data - complete spatial context with summarized values.
                        Ideal for pattern recognition and high-level overview.
                    </div>
                `;
            } else {
                html += `
                    <div style="background: #fce7f3; padding: 16px; border-radius: 8px; border-left: 4px solid #ec4899;">
                        <strong>üì¶ DENSE + üìä ROLLED Quadrant</strong><br>
                        Populated-only view with aggregated data - most compact representation.
                        Ultra-efficient for large datasets with summary information only.
                    </div>
                `;
            }

            // Simulate grid rendering based on Janus state
            const gridData = groupNodesByAxes(nodesData, xAxis, yAxis);

            if (janusState.extentMode === 'dense') {
                // Filter out empty cells
                gridData.cells = gridData.cells.filter(cell => cell.nodes.length > 0);
            }

            html += `
                <div style="margin-top: 16px;">
                    <strong>Grid Cells (${gridData.cells.length}):</strong><br>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 8px; margin-top: 8px;">
            `;

            gridData.cells.slice(0, 20).forEach((cell, index) => {
                const nodeCount = janusState.valueMode === 'rolled'
                    ? Math.ceil(cell.nodes.length / 2.5)  // Simulate compression
                    : cell.nodes.length;

                html += `
                    <div style="
                        background: white;
                        border: 1px solid #e5e7eb;
                        border-radius: 6px;
                        padding: 12px;
                        cursor: pointer;
                        transition: all 0.2s ease;
                        ${cell.nodes.length === 0 ? 'opacity: 0.3; border-style: dashed;' : ''}
                    " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)'"
                       onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                        <div style="font-size: 0.75rem; color: #6b7280; margin-bottom: 4px;">
                            ${cell.rowKey !== 'default' ? cell.rowKey : ''}
                            ${cell.colKey !== 'default' ? '‚Üí' + cell.colKey : ''}
                        </div>
                        <div style="font-weight: 600; color: ${cell.nodes.length > 0 ? '#1f2937' : '#9ca3af'};">
                            ${nodeCount} item${nodeCount !== 1 ? 's' : ''}
                        </div>
                        ${cell.nodes.length > 0 ? `
                            <div style="font-size: 0.7rem; color: #6b7280; margin-top: 4px;">
                                ${janusState.valueMode === 'rolled' ? 'Aggregated' : cell.nodes.slice(0, 1).map(n => n.name).join('')}
                            </div>
                        ` : `
                            <div style="font-size: 0.7rem; color: #9ca3af; margin-top: 4px; font-style: italic;">
                                Empty cell
                            </div>
                        `}
                    </div>
                `;
            });

            html += '</div></div>';

            document.getElementById('gridDisplay').innerHTML = html;
            updateDensityStats();
        }

        function groupNodesByAxes(nodes, xAxis, yAxis) {
            const cells = new Map();
            const columnHeaders = new Set();
            const rowHeaders = new Set();

            nodes.forEach(node => {
                let colKey = 'default';
                let rowKey = 'default';

                if (xAxis) {
                    colKey = extractNodeValue(node, xAxis);
                    columnHeaders.add(colKey);
                }

                if (yAxis) {
                    rowKey = extractNodeValue(node, yAxis);
                    rowHeaders.add(rowKey);
                }

                const cellKey = `${rowKey}:${colKey}`;
                if (!cells.has(cellKey)) {
                    cells.set(cellKey, []);
                }
                cells.get(cellKey).push(node);
            });

            return {
                cells: Array.from(cells.entries()).map(([key, cellNodes]) => {
                    const [rowKey, colKey] = key.split(':');
                    return { rowKey, colKey, nodes: cellNodes };
                }),
                columnHeaders: Array.from(columnHeaders).sort(),
                rowHeaders: Array.from(rowHeaders).sort()
            };
        }

        // Initialize
        generateSampleData(100);
        updateJanusUI();
        renderGrid();

        document.getElementById('status').textContent = 'üåä Janus Density Model initialized! Ready for four-quadrant exploration.';
    </script>
</body>
</html>