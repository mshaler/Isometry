# v5.3 Feature Gaps

**Goal:** Complete remaining feature gaps for production-ready data layer with version history, advanced routing, and faceted search.

**Source:** Feature assessment follow-on items beyond P0-P2 priorities.

**Note:** Renumbered from v5.1 to v5.3 as Phase 80 is now Notebook Integration (v5.1) and Phases 83-85 are Technical Debt (v5.2).

## Requirements

### Phase 86: Version History & Audit (Medium)

**HIST-01: Node Versions Table**
- Create `node_versions` table storing historical snapshots
- Fields: id, node_id, version, snapshot_json, changed_at, changed_by
- Trigger captures snapshot before UPDATE

**HIST-02: Version History UI**
- Version history panel in node detail view
- List of versions with timestamps
- Diff view between versions (optional: highlight changes)

**HIST-03: Version Restore**
- Restore node to previous version
- Increments current version (doesn't overwrite history)
- Confirmation dialog before restore

### Phase 87: Advanced Routing (Medium)

**ROUTE-01: React Router Integration**
- Install and configure React Router
- Define route structure: `/`, `/node/:id`, `/catalog`, `/search`
- Migrate from query param checks to proper routes

**ROUTE-02: View-Specific Routes**
- `/grid`, `/list`, `/kanban`, `/network`, `/timeline` routes
- Preserve view state in route
- Browser back/forward navigates between views

**ROUTE-03: Settings & Preferences Route**
- `/settings` route for user preferences
- Theme selection (NeXTSTEP, Modern)
- Density defaults, default view

### Phase 88: Faceted Search (Medium)

**SEARCH-01: LATCH-Integrated Search**
- SuperSearch facet dropdown triggers actual SQL WHERE clauses
- Combine FTS5 search with LATCH filters
- Show filtered result count

**SEARCH-02: Search Results Page**
- Dedicated search results view
- Group results by folder/type
- Highlight matching text

**SEARCH-03: Tag Browser & Autocomplete**
- Tag autocomplete in filter UI
- Tag cloud visualization
- Click tag to add to filter

**SEARCH-04: Saved Searches**
- Save search + filter combination
- Name and organize saved searches
- Quick access from Navigator

## Success Criteria

1. User views version history and sees all previous versions with timestamps
2. User restores node to previous version and current version increments
3. User navigates via `/node/123` URL and sees that node
4. User searches "meeting" with Time facet set to "last week" and gets scoped results
5. User saves a search and accesses it later from Navigator

## Dependencies

- Depends on: v4.9 Data Layer Completion (Phases 77-79)
- Optional: Can be parallelized after Phase 77 (Versioning) completes

## Phases

| Phase | Name | Plans | Complexity |
|-------|------|-------|------------|
| 86 | Version History | 3 | Medium |
| 87 | Advanced Routing | 3 | Medium |
| 88 | Faceted Search | 4 | Medium |

---
*Created: 2026-02-13*
