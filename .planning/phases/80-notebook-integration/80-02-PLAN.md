---
phase: 80-notebook-integration
plan: 02
type: execute
wave: 2
depends_on: ["80-01"]
files_modified:
  - src/components/IntegratedLayout.tsx
autonomous: false
user_setup: []

must_haves:
  truths:
    - "Expanded panel shows all three Notebook panes (Capture, Shell, Preview)"
    - "Notebook state persists across expand/collapse cycles"
    - "Expanded state respects theme (NeXTSTEP/Modern)"
    - "Smooth expand/collapse animation maintained with content"
  artifacts:
    - path: "src/components/IntegratedLayout.tsx"
      provides: "Full NotebookLayout embedded in collapsible panel"
      contains: "NotebookLayout"
  key_links:
    - from: "src/components/IntegratedLayout.tsx"
      to: "NotebookLayout"
      via: "React component embedding"
      pattern: "<NotebookLayout"
    - from: "NotebookLayout"
      to: "NotebookContext"
      via: "useNotebook hook"
      pattern: "useNotebook\\(\\)"
---

<objective>
Embed the full NotebookLayout component (Capture, Shell, Preview panes) into the collapsible panel skeleton created in Plan 01.

Purpose: Complete the Notebook integration by replacing the placeholder with the actual three-pane NotebookLayout, ensuring state persistence and theme consistency.

Output:
- NotebookLayout embedded in collapsible panel content
- All three panes (Capture, Shell, Preview) visible when expanded
- Notebook state persists when collapsing and re-expanding
- Theme-aware styling throughout the expanded panel
</objective>

<execution_context>
@/Users/mshaler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mshaler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/80-notebook-integration/80-01-SUMMARY.md
@src/components/IntegratedLayout.tsx
@src/components/notebook/NotebookLayout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace placeholder with NotebookLayout</name>
  <files>src/components/IntegratedLayout.tsx</files>
  <action>
1. Add NotebookLayout import at the top of the file:
```tsx
import { NotebookLayout } from './notebook/NotebookLayout';
```

2. Replace the placeholder content inside the expandable panel (the div with "NotebookLayout will be embedded here") with the actual NotebookLayout:

Find this placeholder code:
```tsx
<div className={`h-96 ${isNeXTSTEP ? 'bg-[#1A1A1A]' : 'bg-gray-50'} flex items-center justify-center`}>
  <p className={`text-sm ${mutedColor}`}>
    NotebookLayout will be embedded here (Plan 80-02)
  </p>
</div>
```

Replace with:
```tsx
<div className={`h-96 ${isNeXTSTEP ? 'bg-[#1A1A1A]' : 'bg-gray-50'}`}>
  <NotebookLayout />
</div>
```

Note: NotebookLayout already wraps its content in TerminalProvider and FocusProvider internally (see NotebookLayout.tsx lines 270-278), and NotebookProvider is already wired in App.tsx (Plan 01). No additional context providers needed here.
  </action>
  <verify>
Run `npm run typecheck` - no import errors for NotebookLayout.
Run `npm run dev` and expand the Notebook panel - should see three panes.
  </verify>
  <done>
NotebookLayout component renders inside the collapsible panel content area.
  </done>
</task>

<task type="auto">
  <name>Task 2: Adjust panel height for optimal three-pane display</name>
  <files>src/components/IntegratedLayout.tsx</files>
  <action>
Increase the panel height from h-96 (384px) to a more suitable height for three-pane layout.

Update the expandable content area:

```tsx
{/* Expandable Content Area */}
<div
  id="notebook-panel"
  className={`
    overflow-hidden transition-all duration-300 ease-in-out
    ${isNotebookExpanded ? 'max-h-[28rem]' : 'max-h-0'}
  `}
>
  <div className={`h-[28rem] ${isNeXTSTEP ? 'bg-[#1A1A1A]' : 'bg-gray-50'}`}>
    <NotebookLayout />
  </div>
</div>
```

The height of 28rem (448px) provides:
- Enough vertical space for the three-pane layout
- Room for TipTap editor toolbar in Capture
- Terminal content visibility in Shell
- Preview visualization space

Also update the collapsed header hint text to reflect actual pane status:
```tsx
<span className={`text-[10px] ${mutedColor}`}>
  {isNotebookExpanded ? 'Expanded' : 'Capture / Shell / Preview'}
</span>
```
  </action>
  <verify>
Expand the Notebook panel - all three panes should have reasonable height.
TipTap editor toolbar should be visible in Capture pane.
Terminal area should be visible in Shell pane.
  </verify>
  <done>
Panel height optimized at 28rem (448px) for three-pane display with adequate space for each pane.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Notebook integration with collapsible panel containing all three panes (Capture, Shell, Preview).
  </what-built>
  <how-to-verify>
1. Open http://localhost:5173 in browser
2. Look for "Notebook" header below the Command Bar (collapsed by default)
3. Click the header to expand - verify you see:
   - Three panes side-by-side (Capture / Shell / Preview)
   - TipTap editor area in Capture pane
   - Terminal-like area in Shell pane
   - Preview area on the right
4. Click to collapse - verify smooth animation
5. Type something in the Capture editor
6. Collapse the panel
7. Expand the panel again - verify your typed content persists
8. Check both themes if theme toggle is available:
   - NeXTSTEP: Dark backgrounds (#1A1A1A, #1E1E1E)
   - Modern: Light backgrounds (gray-50, white)
9. Refresh the page - verify panel state (expanded/collapsed) persists
  </how-to-verify>
  <resume-signal>Type "approved" if all checks pass, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
1. `npm run typecheck` passes with zero errors
2. Notebook panel expands to show all three panes
3. Collapse/expand animation remains smooth with content
4. Content typed in Capture persists across collapse/expand cycles
5. Theme colors applied correctly (NeXTSTEP dark / Modern light)
6. Panel height (28rem) provides adequate space for all panes
</verification>

<success_criteria>
- NotebookLayout embedded and rendering inside collapsible panel
- All three panes visible when expanded: Capture, Shell, Preview
- Notebook state (active card, typed content) persists across collapse/expand
- Smooth 300ms animation works with full content
- Theme-aware styling in expanded state matches NeXTSTEP/Modern
- Panel height provides usable space for three-pane workflow
</success_criteria>

<output>
After completion, create `.planning/phases/80-notebook-integration/80-02-SUMMARY.md`
</output>
