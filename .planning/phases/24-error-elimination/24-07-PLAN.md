---
phase: 24-07
type: autonomous
wave: 6
depends_on: [24-06]
---

# Phase 24-07: Complete TypeScript Error Elimination

## Objective

Complete systematic TypeScript error reduction from current ~154 errors to target <30 errors for production readiness through pattern-based fixes and dependency cleanup.

## Context

The checkpoint feedback from Phase 24-06 shows that while significant progress was made, ~154 TypeScript errors remain with the goal of achieving <30 errors. Analysis reveals several categories of remaining issues:

1. **Duplicate dependencies**: `execute, execute` patterns causing React Hook dependency warnings
2. **Type assertions**: 40+ `as any` patterns requiring proper interface definitions
3. **JSZip constructor**: Legacy pattern `new (JSZip as any)()` needs standardization
4. **Mock type mismatches**: Test file patterns requiring proper mock interfaces
5. **Unused parameter cleanup**: Underscore-prefixed parameters triggering linting warnings

@src/hooks/useNotebookIntegration.ts - Contains duplicate execute dependencies
@src/utils/officeDocumentProcessor.ts - Contains JSZip constructor pattern issue
@src/dsl/__tests__ - Contains multiple `as any` mock patterns
@src/utils/__tests__ - Contains WebView bridge `as any` patterns

## Tasks

### Task 1: Fix Duplicate React Hook Dependencies
**Type:** auto
**Tdd:** false

Remove duplicate dependencies in React hook dependency arrays that are causing TypeScript/React Hook warnings.

**Target patterns:**
- `}, [cards, execute, execute]);` → `}, [cards, execute]);`
- `}, [execute, execute]);` → `}, [execute]);`

**Files to fix:**
- `src/hooks/useNotebookIntegration.ts` (lines 163, 222, 291)

**Verification:**
- No duplicate items in React Hook dependency arrays
- TypeScript compilation shows reduced hook warnings
- React Hook warnings eliminated from these specific patterns

### Task 2: Standardize JSZip Constructor Pattern
**Type:** auto
**Tdd:** false

Replace legacy JSZip constructor pattern with standardized approach across all office document processing.

**Pattern fix:**
- From: `new (JSZip as any)()`
- To: `new JSZip()`

**Files to fix:**
- `src/utils/officeDocumentProcessor.ts` (line 790)

**Additional work:**
- Verify JSZip import statement is correct
- Test that zip creation still functions properly
- Update any related type definitions if needed

**Verification:**
- No `as any` usage in JSZip constructor calls
- Office document processing tests pass
- ZIP archive creation works without type errors

### Task 3: Eliminate Test File Type Assertions Batch 1
**Type:** auto
**Tdd:** false

Replace `as any` patterns in test files with proper mock interfaces and type-safe patterns.

**Target files:**
- `src/dsl/__tests__/autocomplete-dynamic.test.ts` (13 instances)
- `src/db/__tests__/schemaLoader.test.ts` (11 instances)

**Pattern fixes:**
- `mockExecute as any` → Define proper `MockDatabaseFunction` interface
- Test result assertions → Use proper typed interfaces
- Mock function patterns → Create typed mock implementations

**Implementation approach:**
1. Define `MockDatabaseFunction` interface with proper signatures
2. Update mock implementations to use interface
3. Replace `as any` casts with interface-typed mocks
4. Verify all tests still pass

**Verification:**
- No `as any` patterns in target test files
- All tests pass with proper type safety
- Mock implementations use proper interfaces

### Task 4: Eliminate Utility Test Type Assertions Batch 2
**Type:** auto
**Tdd:** false

Remove remaining `as any` patterns from utility test files and implement proper WebView bridge interfaces.

**Target files:**
- `src/utils/__tests__/webview-bridge-reliability.test.ts` (7 instances)
- `src/utils/__tests__/enhanced-sync.test.ts` (3 instances)
- `src/test/` files (5 instances)

**Pattern fixes:**
- `(mockWindow.webkit.messageHandlers as any)` → Define proper WebKit interface
- `(result as any)` → Use proper typed result interfaces
- Mock type patterns → Create comprehensive test interfaces

**Implementation approach:**
1. Create `MockWebKitInterface` for WebView bridge testing
2. Define proper result type interfaces for test assertions
3. Update mock window implementations with typed interfaces
4. Replace all `as any` with proper typed patterns

**Verification:**
- No `as any` patterns in utility test files
- WebView bridge tests properly typed
- All utility tests pass with type safety

### Task 5: Clean Up Unused Parameter Warning Patterns
**Type:** auto
**Tdd:** false

Address remaining unused parameter patterns that may be triggering TypeScript warnings despite underscore prefixes.

**Target approach:**
- Review underscore-prefixed parameters for actual usage
- Convert truly unused parameters to proper TypeScript ignore patterns
- Update function signatures to match actual usage patterns

**Files to review:**
- Functions with `_message`, `_result`, `_duration` patterns
- Event handlers with unused event parameters
- Callback functions with optional parameters

**Implementation approach:**
1. Identify underscore parameters causing warnings
2. Use TypeScript comment ignore patterns where appropriate
3. Remove parameters entirely if truly unused
4. Update function signatures for consistency

**Verification:**
- No unused parameter warnings from TypeScript
- Function signatures match actual usage patterns
- All callbacks and handlers work correctly

## Verification

### Build Verification
- `npm run typecheck` shows <30 TypeScript errors (target achieved)
- `npm run build` succeeds with minimal warnings
- No React Hook dependency warnings in development console

### Pattern Verification
- Zero `as any` patterns in test files
- Zero duplicate dependencies in React hooks
- Standardized JSZip constructor usage
- Clean unused parameter handling

### Test Coverage
- All existing tests continue to pass
- No new type-related test failures
- Mock interfaces provide proper type safety

## Success Criteria

1. **Error Count Reduction**: TypeScript error count reduced to <30 (from ~154)
2. **Pattern Consistency**: No `as any` type assertions in test files
3. **Hook Hygiene**: No duplicate dependencies in React hook arrays
4. **Constructor Standardization**: JSZip constructor uses standard pattern
5. **Build Success**: Clean build with minimal warnings
6. **Type Safety**: Proper interfaces throughout test infrastructure
7. **Parameter Cleanup**: No unused parameter warnings from TypeScript compiler

## Completion Definition

Phase 24-07 is complete when:
- TypeScript error count is <30 (verified by `npx tsc --noEmit | grep "error TS" | wc -l`)
- All target `as any` patterns eliminated from test files
- React Hook dependency duplications removed
- JSZip constructor standardized
- All tests pass with proper type safety
- Build pipeline produces clean output with minimal warnings