---
phase: 11-type-safety-migration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [
  "src/components/demo/CbCanvasDemo.tsx",
  "src/components/demo/D3ViewWrapperDemo.tsx",
  "src/components/demo/LATCHScalesDemo.tsx",
  "src/utils/officeDocumentProcessor.ts",
  "src/types/d3-types.ts",
  "src/types/document-processor.ts"
]
autonomous: true

must_haves:
  truths:
    - "npm run lint returns '✖ 0 problems (0 errors, 0 warnings)'"
    - "D3 component demos render correctly with proper type safety"
    - "Office document processor handles all file types with type-safe transforms"
    - "All explicit 'any' types replaced with proper interfaces"
  artifacts:
    - path: "src/types/d3-types.ts"
      provides: "D3 component and scale type definitions"
      contains: "CardComponentSelection, D3Scale"
    - path: "src/types/document-processor.ts"
      provides: "Document transform function interfaces"
      contains: "TransformFunction, ProcessorOptions"
    - path: "src/components/demo/CbCanvasDemo.tsx"
      provides: "Type-safe D3 card component integration"
      min_lines: 60
    - path: "src/utils/officeDocumentProcessor.ts"
      provides: "Type-safe document transformation"
      exports: ["processOfficeDocument"]
  key_links:
    - from: "src/components/demo/*.tsx"
      to: "src/types/d3-types.ts"
      via: "D3Scale and CardComponentSelection imports"
      pattern: "import.*D3Scale.*from.*d3-types"
    - from: "src/utils/officeDocumentProcessor.ts"
      to: "src/types/document-processor.ts"
      via: "TransformFunction interface usage"
      pattern: "TransformFunction.*=>"
---

<objective>
Complete TypeScript strict mode compliance by eliminating remaining explicit 'any' types and implementing proper type definitions for D3 visualizations and document processing.

Purpose: Establish comprehensive type safety foundation that enables strict mode compilation across all modules, addressing the final 5 ESLint warnings and TypeScript errors identified in the Phase 10-11 gap analysis.

Output: Zero ESLint warnings and strict-mode-compliant TypeScript codebase with proper D3 and document processor type definitions.
</objective>

<execution_context>
@/Users/mshaler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mshaler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md

# Phase 10 completion established perfect ESLint foundation
@.planning/phases/10-foundation-cleanup/10-11-SUMMARY.md

# Phase 11 error handling and bridge reliability completed
@.planning/phases/11-type-safety-migration/11-02-SUMMARY.md
@.planning/phases/11-type-safety-migration/11-03-SUMMARY.md

# Current gap analysis shows 5 explicit any warnings
@.planning/phases/10-foundation-cleanup/10-foundation-cleanup-VERIFICATION.md
</context>

<tasks>

<task type="auto">
  <name>D3 Component Type Safety Implementation</name>
  <files>src/types/d3-types.ts, src/components/demo/CbCanvasDemo.tsx, src/components/demo/D3ViewWrapperDemo.tsx, src/components/demo/LATCHScalesDemo.tsx</files>
  <action>
    Create comprehensive D3 type definitions to replace the 4 explicit 'any' types in demo components:

    1. Create src/types/d3-types.ts with proper interfaces:
       - CardComponentSelection interface for D3 selections with card-specific methods
       - D3Scale interface covering linear, ordinal, and band scales used in demos
       - ScaleDomain and ScaleRange types for type-safe extent usage

    2. Update CbCanvasDemo.tsx (line 63): Replace `as any` with proper CardComponentSelection type
    3. Update D3ViewWrapperDemo.tsx (line 51): Replace `as any` with D3Scale interface
    4. Update LATCHScalesDemo.tsx (lines 51, 63): Replace both `as any` with D3Scale interface

    Use the established pattern from Phase 10-11 where D3 extent functions are wrapped with safe guards and proper type casting, following the IIFE pattern established in other D3 components.
  </action>
  <verify>npm run lint shows 1 remaining warning (down from 5), all D3 demos render correctly without console errors</verify>
  <done>4 explicit any types eliminated in D3 components with proper type safety maintained</done>
</task>

<task type="auto">
  <name>Office Document Processor Type Safety</name>
  <files>src/types/document-processor.ts, src/utils/officeDocumentProcessor.ts</files>
  <action>
    Complete type safety for document processing by eliminating the remaining explicit any type:

    1. Create src/types/document-processor.ts with:
       - TransformFunction interface defining (element: ParsedElement) => ParsedElement signature
       - ProcessorOptions interface with optional transform property
       - ParsedElement interface extending existing DocumentStyle with proper typing

    2. Update officeDocumentProcessor.ts line 310:
       - Replace `transform: any` parameter with `transform: TransformFunction`
       - Add proper import from document-processor types
       - Ensure transform function calls use typed parameters throughout

    Reference the existing DocumentStyle and ParsedElement interfaces established in Phase 10 to maintain consistency with the comprehensive document interface pattern.
  </action>
  <verify>npm run lint returns '✖ 0 problems (0 errors, 0 warnings)', office document import functionality works correctly</verify>
  <done>Final explicit any type eliminated with complete type safety for document processing</done>
</task>

<task type="auto">
  <name>TypeScript Strict Mode Validation</name>
  <files>tsconfig.json</files>
  <action>
    Validate and enable full TypeScript strict mode compilation:

    1. Run `npx tsc --noEmit --strict` to identify any remaining type errors
    2. If errors remain from previous phases, create minimal fixes following established patterns:
       - Use proper interface extensions for global objects (WindowWithErrorReporting pattern)
       - Apply the underscore parameter omission strategy for intentionally unused parameters
       - Use comprehensive interface definitions rather than any escape hatches

    3. Once compilation succeeds, document successful strict mode achievement
    4. Update tsconfig.json to ensure strict mode is properly configured for development

    Do not modify tsconfig.build.json - keep the separated build configuration established in Phase 10-06.
  </action>
  <verify>npx tsc --noEmit --strict completes with exit code 0, no TypeScript compilation errors</verify>
  <done>Complete TypeScript strict mode compliance achieved across entire codebase</done>
</task>

</tasks>

<verification>
- Run `npm run lint` and confirm "✖ 0 problems (0 errors, 0 warnings)"
- Run `npx tsc --noEmit --strict` and confirm successful compilation
- Test all D3 demo components render correctly in browser
- Test office document import functionality works without errors
- Verify no new `any` types introduced during implementation
</verification>

<success_criteria>
1. Complete elimination of all 5 remaining ESLint warnings
2. TypeScript strict mode compilation succeeds with zero errors
3. All D3 visualizations maintain functionality with proper type safety
4. Document processing maintains full functionality with type safety
5. No performance regression in any affected components
6. Foundation established for TYPE-01 requirement completion
</success_criteria>

<output>
After completion, create `.planning/phases/11-type-safety-migration/11-01-SUMMARY.md`
</output>