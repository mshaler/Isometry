# Plan 58-02: Navigator Redesign (Figma Compliance)

## Summary

Redesign Navigator to match Figma specifications. The current implementation deviated from the Figma design by merging LATCH+GRAPH and PAFV navigators into a two-column horizontal accordion layout. This plan restores the intended design:

1. **LatchNavigator**: 6-column vertical grid (L, A, T, C, H, GRAPH)
2. **PafvNavigator**: 5-well horizontal drop zones (Available, X, Y, Z, Density)

## Context

**Problem**: Current Navigator uses accordion sections with a narrow right column for drop zones. This differs from the Figma design which shows:
- LatchNavigator as a 6-column grid with property chips under each column
- PafvNavigator as 5 horizontal drop wells with drag-and-drop

**Impact**:
- Navigator takes excessive vertical space, reducing SuperGrid real estate
- UX inconsistent with approved Figma design

**Figma Reference Files**:
- `/tmp/figma-export/LatchNavigator.tsx` - 6-column grid layout
- `/tmp/figma-export/PafvNavigator.tsx` - 5-well horizontal layout

## Scope

### In Scope
1. Create new LatchNavigator component matching Figma 6-column grid
2. Create new PafvNavigator component matching Figma 5-well layout
3. Update IntegratedLayout to use both components
4. Maximize SuperGrid vertical space
5. Preserve existing drag-and-drop functionality

### Out of Scope
- Advanced PAFV controls (defer to future phase)
- Z-plane implementation (placeholder only)
- Audit view toggle (placeholder only)

## Tasks

### Task 1: Create LatchNavigator Component
**File**: `src/components/navigator/LatchNavigator.tsx` (CREATE)

Create 6-column grid layout per Figma:
- Grid columns: L, A, T, C, H, GRAPH
- Each column has: header with icon + count badge, collapsible property list
- Property chips have: checkbox, display name, type icon
- Compact height: max-h-48 with overflow scroll

```typescript
// Key structure from Figma:
<div className="grid grid-cols-6 gap-1 p-1">
  {LATCH_COLUMNS.map(column => (
    <div className="flex flex-col">
      <button className="header">L/A/T/C/H/GRAPH</button>
      <div className="property-list">
        {properties.map(prop => <PropertyChip />)}
      </div>
    </div>
  ))}
</div>
```

### Task 2: Create PafvNavigator Component
**File**: `src/components/navigator/PafvNavigator.tsx` (CREATE)

Create 5-well horizontal layout per Figma:
- Available Properties: 28% width
- X-Plane (Columns): 18% width
- Y-Plane (Rows): 18% width
- Z-Plane (Layers): 18% width (with embedded controls)
- Sparsity↔Density: 18% width (vertical slider)

Uses react-dnd for drag-and-drop between wells.

```typescript
// Key structure from Figma:
<div className="flex gap-2">
  <div className="w-[28%]">Available</div>
  <div className="w-[18%]">X-Plane</div>
  <div className="w-[18%]">Y-Plane</div>
  <div className="w-[18%]">Z-Plane</div>
  <div className="w-[18%]">Density</div>
</div>
```

### Task 3: Create Shared Types
**File**: `src/components/navigator/types.ts` (MODIFY)

Ensure proper types for inter-component communication:
- LatchProperty interface
- PafvWell types
- DnD item types

### Task 4: Update IntegratedLayout
**File**: `src/components/IntegratedLayout.tsx` (MODIFY)

Replace current Navigator with stacked LatchNavigator + PafvNavigator:
```
┌─────────────────────────────────────────────┐
│ LatchNavigator (6-column grid, max-h-48)    │
├─────────────────────────────────────────────┤
│ PafvNavigator (5-well horizontal, h-64)     │
├─────────────────────────────────────────────┤
│ SuperGrid (MAXIMIZE - flex-1)               │
├─────────────────────────────────────────────┤
│ Command Bar                                 │
└─────────────────────────────────────────────┘
```

### Task 5: Remove Old Navigator Code
**File**: `src/components/Navigator.tsx` (MODIFY)

Keep top toolbar (Apps/Views/Datasets dropdowns) but remove SimplePAFVNavigator.
The new LatchNavigator + PafvNavigator will replace it.

## Verification

```bash
npm run check:types
npm run dev
# Navigate to /?test=integrated
# Verify:
# 1. LatchNavigator shows 6-column grid (L, A, T, C, H, GRAPH)
# 2. PafvNavigator shows 5 horizontal wells
# 3. SuperGrid fills remaining vertical space
# 4. Drag-and-drop works between Available well and X/Y wells
# 5. Property checkboxes toggle correctly
```

## Files Changed

| File | Action | Description |
|------|--------|-------------|
| `src/components/navigator/LatchNavigator.tsx` | CREATE | 6-column grid layout |
| `src/components/navigator/PafvNavigator.tsx` | CREATE | 5-well horizontal layout |
| `src/components/navigator/types.ts` | MODIFY | Shared types |
| `src/components/IntegratedLayout.tsx` | MODIFY | Stack new navigators |
| `src/components/Navigator.tsx` | MODIFY | Remove SimplePAFVNavigator |

## Dependencies

- Phase 57-03 complete (encoding dropdowns, drag-and-drop)
- Figma export files at `/tmp/figma-export/`
- react-dnd already configured

## Estimated Complexity

Medium - Structural redesign with existing component patterns.

---

*Plan: 58-02*
*Phase: 58 - Transitions & Polish*
*Status: ✅ COMPLETED 2026-02-11*

## Completion Summary

All tasks completed:
- ✅ Task 1: Created LatchNavigator (6-column LATCH+GRAPH grid)
- ✅ Task 2: Created PafvNavigator (5-well horizontal with density slider)
- ✅ Task 3: Created NavigatorToolbar (toolbar extraction)
- ✅ Task 4: Updated IntegratedLayout (stacked navigators, maximized SuperGrid)
- ✅ Task 5: Fixed sample data loading (SAMPLE_DATA_SQL executed)

Files created:
- `src/components/navigator/LatchNavigator.tsx`
- `src/components/navigator/PafvNavigator.tsx`
- `src/components/NavigatorToolbar.tsx`

Files modified:
- `src/components/IntegratedLayout.tsx`
- `src/db/SQLiteProvider.tsx`
