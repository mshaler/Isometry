---
phase: 10-foundation-cleanup
plan: 27
type: execute
wave: 1
depends_on: []
files_modified: [
  "src/contexts/notebook/templateManager.ts",
  "src/contexts/NotebookContext.tsx",
  "src/types/notebook.ts",
  "src/contexts/PAFVContext.tsx"
]
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "TypeScript compiler produces no errors with strict mode enabled"
    - "Notebook context template management functions correctly"
    - "Template creation and deletion operations work without type errors"
  artifacts:
    - path: "src/contexts/notebook/templateManager.ts"
      provides: "Type-safe template creation and management functions"
      exports: ["createTemplateManager"]
    - path: "src/contexts/NotebookContext.tsx"
      provides: "Type-safe notebook context with proper hook integration"
      exports: ["NotebookContext", "useNotebook"]
    - path: "src/types/notebook.ts"
      provides: "Proper template creation utility function"
      exports: ["createNotebookTemplate"]
  key_links:
    - from: "src/contexts/notebook/templateManager.ts"
      to: "src/types/notebook.ts"
      via: "createNotebookTemplate function call"
      pattern: "createNotebookTemplate\\("
    - from: "src/contexts/NotebookContext.tsx"
      to: "templateManager functions"
      via: "createTemplateManager hook calls"
      pattern: "createTemplateManager\\("
---

<objective>
Resolve TypeScript strict mode errors in notebook context and template management system.

Purpose: Fix the remaining 246 TypeScript errors by addressing core type interface mismatches in the notebook system, focusing on template manager function signatures and context hook integration issues identified in verification gaps.
Output: Type-safe notebook context with proper template management and zero TypeScript strict mode errors in core notebook functionality.
</objective>

<execution_context>
@/Users/mshaler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mshaler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-foundation-cleanup/10-VERIFICATION.md
@.planning/phases/10-foundation-cleanup/10-26-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Fix Template Manager Function Signatures and Type Interfaces</name>
  <files>src/contexts/notebook/templateManager.ts</files>
  <action>
    Fix template manager TypeScript strict mode errors by addressing these issues:

    1. **createNotebookCardTemplate function call (lines 57-63)**: The function expects 1-2 arguments (nodeId: string, cardType?: NotebookCardType) but is being called with 5 arguments. Replace with proper template creation logic that constructs a NotebookTemplate object directly.

    2. **NotebookCard type property (line 62)**: NotebookCard interface has 'cardType' property, not 'type'. Change fromCard.type to fromCard.cardType.

    3. **Template creation return type (lines 69, 71)**: The function should return NotebookTemplate but createNotebookCardTemplate returns Partial<NotebookCard>. Create proper template object with all required NotebookTemplate properties.

    4. **Type compatibility in saveCustomTemplates (lines 69, 113)**: Ensure arrays passed to saveCustomTemplates are properly typed as NotebookTemplate[] not mixed arrays.

    Implementation approach:
    - Create a proper createNotebookTemplate helper function in src/types/notebook.ts if needed
    - Fix function signatures to match interface expectations
    - Use fromCard.cardType instead of fromCard.type
    - Ensure all template objects have required NotebookTemplate properties (name, description, category, tags, etc.)
  </action>
  <verify>npx tsc --noEmit --skipLibCheck src/contexts/notebook/templateManager.ts</verify>
  <done>Template manager compiles without TypeScript strict mode errors and template creation functions use correct argument counts and property names</done>
</task>

<task type="auto">
  <name>Resolve Notebook Context Hook Integration Type Mismatches</name>
  <files>src/contexts/NotebookContext.tsx</files>
  <action>
    Fix NotebookContext TypeScript strict mode errors by addressing these specific issues:

    1. **createTemplateManager call (line 31)**: Expected 0 arguments but got 1. Check templateManager constructor and either remove the argument or update the function signature.

    2. **useNotebookPerformance call (line 38)**: Expected 1 arguments but got 0. Provide required argument or update hook signature.

    3. **createCardOperations call (lines 41-42)**: Expected 0/2 arguments but got 1/3. Fix argument count to match function signature.

    4. **useNotebookIntegration hook (lines 49-54)**: Fix 'isEnabled' property not existing in NotebookHookParams interface and implicit 'any' parameter types.

    5. **Undefined variable references (lines 178, 182, 187, 193, 226, 249, 260, 272)**: Variables like 'updates', 'description', 'newName', 'position' are referenced but not defined. Either define these variables or remove references.

    6. **Missing properties on hook returns (lines 334-346)**: Properties like 'connect', 'disconnect', 'syncCard', 'clearData', 'dismissAlert', 'applySuggestion' don't exist on hook return types. Update return type interfaces or remove property access.

    Reference existing patterns from Plan 10-26 for service interface integration and function argument handling.
  </action>
  <verify>npx tsc --noEmit --skipLibCheck src/contexts/NotebookContext.tsx</verify>
  <done>NotebookContext compiles without TypeScript strict mode errors and all hook integrations use correct argument counts and property names</done>
</task>

<task type="auto">
  <name>Fix Remaining High-Impact Type Interface Issues</name>
  <files>src/contexts/PAFVContext.tsx</files>
  <action>
    Fix remaining high-impact TypeScript strict mode errors to significantly reduce the error count:

    1. **PAFVContext variable reference (line 68)**: Cannot find name 'chipId'. Should reference 'chip' variable instead based on context.

    2. **Create proper template helper function in types/notebook.ts**: Add a createNotebookTemplate function that creates complete NotebookTemplate objects (not Partial<NotebookCard>) with all required properties to support the template manager.

    Implementation approach:
    - Fix variable name references to use correct variable names
    - Add proper template creation utility function if missing
    - Apply established patterns from previous plans for type safety
    - Ensure all property references match interface definitions

    Reference patterns from Plan 10-26 for proper variable reference handling and interface compliance.
  </action>
  <verify>npx tsc --noEmit --skipLibCheck src/contexts/PAFVContext.tsx src/types/notebook.ts</verify>
  <done>Core context files compile without TypeScript strict mode errors and variable references use correct names matching their definitions</done>
</task>

</tasks>

<verification>
Run comprehensive TypeScript strict mode verification:
- npx tsc --noEmit --skipLibCheck (should show significant reduction in error count)
- npm run lint (should maintain 0 problems)
- npm run build (should complete successfully)
</verification>

<success_criteria>
- TypeScript strict mode error count reduced from 246 to under 100 errors (60%+ reduction)
- Template manager functions work without argument count mismatches
- NotebookContext hook integrations use correct property names and argument counts
- Variable references point to correctly defined variables
- Core notebook functionality maintains type safety
- ESLint compliance preserved at 0 problems
- Production build continues to function correctly
</success_criteria>

<output>
After completion, create `.planning/phases/10-foundation-cleanup/10-27-SUMMARY.md`
</output>