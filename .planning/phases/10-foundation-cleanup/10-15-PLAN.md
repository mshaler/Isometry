---
phase: 10-foundation-cleanup
plan: 15
type: execute
wave: 2
depends_on: [10-13, 10-14]
files_modified: [
  "src/components/notebook/CaptureComponent.tsx",
  "src/components/notebook/PropertyEditor.tsx",
  "src/components/notebook/property-editor/CustomFieldAdder.tsx",
  "src/components/PAFVNavigator.tsx",
  "src/components/SQLiteImportWizard.tsx",
  "src/components/views/ChartsView.tsx",
  "src/utils/bridge-performance.ts",
  "src/utils/commandHistory.ts",
  "src/utils/d3Parsers.ts"
]
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "TypeScript compiler produces no errors with strict mode enabled"
    - "All notebook components compile without type errors"
    - "D3 components maintain proper type safety"
    - "Utility modules pass strict type checking"
  artifacts:
    - path: "src/components/notebook/CaptureComponent.tsx"
      provides: "Strict mode compliant capture component"
      contains: "GlobalErrorReporting interface consistency"
    - path: "src/components/notebook/PropertyEditor.tsx"
      provides: "Type-safe property editor implementation"
      contains: "PropertyDefinition with required id field"
    - path: "src/components/views/ChartsView.tsx"
      provides: "Type-safe D3 chart implementations"
      contains: "proper Arc and ColorScale definitions"
    - path: "src/utils/"
      provides: "Strict mode compliant utility modules"
      contains: "proper type guards and error handling"
  key_links:
    - from: "GlobalErrorReporting interface"
      to: "notebook components"
      via: "consistent method names"
      pattern: "reportError|reportUserError consistency"
    - from: "PropertyDefinition interface"
      to: "CustomFieldAdder"
      via: "required id property"
      pattern: "PropertyDefinition.*id.*string"
---

<objective>
Complete TypeScript strict mode compliance by fixing ~150 compilation errors concentrated in notebook components, D3 integrations, and utility modules.

Purpose: Achieve complete TypeScript strict mode foundation for Phase 10's comprehensive type safety goal
Output: Zero TypeScript strict mode compilation errors across entire codebase
</objective>

<execution_context>
@/Users/mshaler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mshaler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/10-foundation-cleanup/10-VERIFICATION.md

# Depends on prior gap closure plans completing ESLint warning fixes
@.planning/phases/10-foundation-cleanup/10-13-SUMMARY.md
@.planning/phases/10-foundation-cleanup/10-14-SUMMARY.md

# Core files with strict mode errors
@src/components/notebook/CaptureComponent.tsx
@src/components/notebook/PropertyEditor.tsx
@src/components/views/ChartsView.tsx
</context>

<tasks>

<task type="auto">
  <name>Fix GlobalErrorReporting interface consistency</name>
  <files>src/components/notebook/CaptureComponent.tsx, src/components/notebook/PropertyEditor.tsx</files>
  <action>
    Fix GlobalErrorReporting interface method name mismatches causing strict mode errors:

    1. Analyze current GlobalErrorReporting interface definition and standardize method names:
    ```typescript
    interface GlobalErrorReporting {
      reportError: (error: Error, context?: string) => void;
      reportUserError: (message: string, context?: string) => void;  // Add if missing
      reportUserInfo: (message: string, context?: string) => void;   // Add if missing
      reportUserWarning: (message: string, context?: string) => void; // Add if missing
    }
    ```

    2. In CaptureComponent.tsx, fix method calls:
    - Line 68: Change `reportUserError` usage to match interface
    - Line 77: Fix `reportUserInfo` method call
    - Line 88: Fix `reportUserWarning` method call

    3. In PropertyEditor.tsx, fix method calls:
    - Line 59: Change `reportUserError` usage to match interface
    - Line 68: Fix `reportUserInfo` method call
    - Line 77: Fix `reportUserWarning` method call

    4. Resolve property declaration conflicts causing TS2717 errors

    Gap reason: Multiple TS2551 and TS2339 errors for missing GlobalErrorReporting methods
  </action>
  <verify>npx tsc --noEmit --strict src/components/notebook/CaptureComponent.tsx src/components/notebook/PropertyEditor.tsx</verify>
  <done>Notebook components use consistent GlobalErrorReporting interface without type errors</done>
</task>

<task type="auto">
  <name>Fix PropertyDefinition and validation types</name>
  <files>src/components/notebook/property-editor/CustomFieldAdder.tsx, src/components/notebook/PropertyEditor.tsx</files>
  <action>
    Fix PropertyDefinition interface and validation typing issues:

    1. In CustomFieldAdder.tsx, add missing 'id' field to PropertyDefinition:
    ```typescript
    const newProperty: PropertyDefinition = {
      id: crypto.randomUUID(), // Add required id field
      name: propertyName,
      type: propertyType as PropertyType,
      required: false,
      description: description || `${propertyName} property`
    };
    ```

    2. In PropertyEditor.tsx, fix validation result typing:
    - Line 47: Fix callback parameter typing for props validation
    - Line 97: Fix validation result access (.isValid and .error properties)
    ```typescript
    const validationResult = await validateProperties(props);
    if (!validationResult.isValid) {
      console.error('Validation failed:', validationResult.error);
    }
    ```

    3. Ensure ValidationResult interface includes isValid and error properties

    Gap reason: TS2741 error for missing 'id' property and TS2339 errors for validation properties
  </action>
  <verify>npx tsc --noEmit --strict src/components/notebook/property-editor/CustomFieldAdder.tsx src/components/notebook/PropertyEditor.tsx</verify>
  <done>Property definition and validation types are strict mode compliant</done>
</task>

<task type="auto">
  <name>Fix utility modules and remaining components</name>
  <files>src/components/PAFVNavigator.tsx, src/components/SQLiteImportWizard.tsx, src/components/views/ChartsView.tsx, src/utils/bridge-performance.ts, src/utils/commandHistory.ts, src/utils/d3Parsers.ts</files>
  <action>
    Complete strict mode compliance for remaining modules with concentrated fixes:

    1. PAFVNavigator.tsx - Fix Wells type usage:
    ```typescript
    // Ensure Wells interface has proper key types
    const wellKey = wellName as keyof Wells;
    ```

    2. SQLiteImportWizard.tsx - Fix missing import and implicit any:
    ```typescript
    // Remove or properly implement sqliteSyncManager import
    // Add proper typing for 'prev' parameter
    ```

    3. ChartsView.tsx - Fix D3 Arc and ColorScale definitions:
    ```typescript
    interface D3Arc {
      innerRadius: number;
      outerRadius: number;
      startAngle: number;
      endAngle: number;
    }
    interface ColorScale {
      domain: () => string[];
      range: () => string[];
    }
    ```

    4. Bridge-performance.ts - Add proper type guards and error handling
    5. CommandHistory.ts - Fix implicit any types in command processing
    6. D3Parsers.ts - Ensure proper D3 type definitions for parsing functions

    Gap reason: Various TS2345, TS2307, TS7006 errors across utility modules and remaining components
  </action>
  <verify>npx tsc --noEmit --strict src/components/ src/utils/</verify>
  <done>All components and utilities pass TypeScript strict mode compilation</done>
</task>

</tasks>

<verification>
- Run `npx tsc --noEmit --strict` and confirm zero compilation errors
- Verify production build still functions: `npm run build`
- Test notebook functionality to ensure no regressions
- Confirm D3 charts and utilities maintain proper functionality
</verification>

<success_criteria>
- TypeScript strict mode compilation produces zero errors
- All notebook components maintain full functionality
- D3 chart integrations remain visually and functionally correct
- Utility modules pass strict type checking without implicit any types
- Phase 10 "complete TypeScript strict mode compliance" goal achieved
</success_criteria>

<output>
After completion, create `.planning/phases/10-foundation-cleanup/10-15-SUMMARY.md`
</output>