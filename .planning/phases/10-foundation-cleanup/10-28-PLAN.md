---
phase: 10-foundation-cleanup
plan: 28
type: execute
wave: 1
depends_on: []
files_modified: [
  "src/d3/hooks/useD3DataBinding.ts",
  "src/utils/__tests__/enhanced-sync.test.ts",
  "src/test/setup.ts"
]
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "TypeScript compiler produces no errors with strict mode enabled"
    - "D3 data binding hooks have proper generic type constraints"
    - "Test files comply with TypeScript strict mode requirements"
  artifacts:
    - path: "src/d3/hooks/useD3DataBinding.ts"
      provides: "Type-safe D3 data binding with generic constraints"
      exports: ["useD3DataBinding", "DataBindingOptions", "DataBindingResult"]
    - path: "TypeScript compilation"
      provides: "Zero compilation errors"
      contains: "Successfully compiled TypeScript"
  key_links:
    - from: "D3 generic types"
      to: "Selection type compatibility"
      via: "proper generic constraints"
      pattern: "Selection<TElement, TDatum, TElement, unknown>"
    - from: "Test files"
      to: "TypeScript strict mode"
      via: "type assertion handling"
      pattern: "as.*unknown.*as"
---

<objective>
Complete Phase 10 TypeScript strict mode compliance by eliminating the remaining 209 compilation errors.

Purpose: Achieve absolute zero TypeScript strict mode errors to complete Phase 10 Foundation Cleanup with full type safety compliance
Output: Zero TypeScript compilation errors, production-ready type-safe codebase
</objective>

<execution_context>
@/Users/mshaler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mshaler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-foundation-cleanup/10-27-SUMMARY.md
@.planning/phases/10-foundation-cleanup/10-26-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Fix D3 Data Binding Generic Type Constraints</name>
  <files>src/d3/hooks/useD3DataBinding.ts</files>
  <action>
    Fix the primary D3 generic type constraint mismatches causing Selection type compatibility issues:

    1. Fix line 78 key function type mismatch:
       - Current: `(datum: TDatum, _index: number, groups: ArrayLike<TElement>) => string`
       - Issue: ArrayLike<TElement> vs ArrayLike<BaseType | TElement>
       - Solution: Adjust generic constraints or use proper type assertion

    2. Fix line 82-83 Selection type mismatches:
       - Current: `Selection<EnterElement, TDatum, BaseType, unknown>` vs `Selection<EnterElement, TDatum, TElement, unknown>`
       - Issue: BaseType vs TElement incompatibility
       - Solution: Use proper type assertion or adjust generic constraints

    3. Fix line 92 onUpdate parameter type mismatch:
       - Current: `Selection<TElement, TDatum, BaseType, unknown>` vs `Selection<TElement, TDatum, TElement, unknown>`
       - Solution: Ensure consistent parent element typing

    Reference existing patterns from Plan 10-27: Function signature compatibility, proper type interface alignment.
    Use type assertions with `as unknown as` pattern if necessary for complex D3 generic scenarios.
  </action>
  <verify>npx tsc --noEmit --strict src/d3/hooks/useD3DataBinding.ts</verify>
  <done>D3 data binding hook compiles without TypeScript strict mode errors</done>
</task>

<task type="auto">
  <name>Fix Test File TypeScript Strict Mode Violations</name>
  <files>src/utils/__tests__/enhanced-sync.test.ts, src/test/setup.ts</files>
  <action>
    Eliminate TypeScript strict mode errors in the top error-producing test files:

    1. enhanced-sync.test.ts (35 errors):
       - Fix any type assertions and implicit any violations
       - Add proper type annotations for test variables
       - Use proper mock types instead of any

    2. setup.ts (15 errors):
       - Fix test environment setup type issues
       - Properly type global test utilities
       - Add type annotations for test configuration

    Apply established patterns from Plans 10-26/27:
    - Use explicit type interfaces instead of any
    - Apply proper type assertions with unknown intermediate
    - Maintain consistent parameter typing patterns
    - Use service singleton import patterns where applicable

    Focus on highest-impact errors first to maximize reduction.
  </action>
  <verify>npx tsc --noEmit --strict src/utils/__tests__/enhanced-sync.test.ts src/test/setup.ts</verify>
  <done>Top test files compile without TypeScript strict mode errors</done>
</task>

<task type="auto">
  <name>Complete Remaining TypeScript Strict Mode Error Elimination</name>
  <files>Multiple TypeScript files (remaining error sources)</files>
  <action>
    Address remaining TypeScript strict mode errors systematically:

    1. Run full TypeScript compilation check to identify remaining error count
    2. Target next highest-impact files from error count analysis:
       - src/utils/__tests__/webview-bridge-reliability.test.ts (13 errors)
       - src/test/data-integrity-validation.test.ts (10 errors)
       - Other files with 7+ errors

    3. Apply established type safety patterns:
       - D3 axis domain union type handling (from Plan 10-26)
       - Function signature compatibility (from Plan 10-27)
       - Service singleton import patterns
       - Proper type assertion chains with unknown intermediate

    4. For any remaining complex cases:
       - Use incremental approach targeting files with highest error counts
       - Apply type assertion patterns: `value as unknown as TargetType`
       - Ensure all changes maintain runtime functionality

    Target: Reduce from 209 errors to under 50 errors, ideally achieving zero.
  </action>
  <verify>npx tsc --noEmit --strict</verify>
  <done>TypeScript compiler produces zero errors with strict mode enabled</done>
</task>

</tasks>

<verification>
1. Run `npx tsc --noEmit --strict` and confirm zero compilation errors
2. Run `npm run lint` and confirm continued zero ESLint problems
3. Run `npm run build` and confirm successful production build
4. Run `npm test` and confirm all tests continue passing
</verification>

<success_criteria>
- TypeScript compiler produces no errors with strict mode enabled
- ESLint continues to report zero problems (0 errors, 0 warnings)
- Production build completes successfully
- All existing tests continue to pass
- D3 data binding system maintains full functionality with type safety
</success_criteria>

<output>
After completion, create `.planning/phases/10-foundation-cleanup/10-28-SUMMARY.md`
</output>