---
phase: 10-foundation-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [
  "src/server/launch-native-server.js",
  "src/hooks/useClaudeAPI.ts",
  "src/hooks/useNotebookIntegration.ts",
  "src/hooks/useNodeTree.ts",
  "src/hooks/useOptimizedQueries.ts",
  "src/hooks/useSQLiteQuery.ts",
  "src/hooks/useWebPreview.ts",
  "src/hooks/useFileSystem.ts",
  "src/utils/list-grouping.ts",
  "src/utils/migration-validator.ts",
  "src/utils/filter-presets.ts",
  "src/utils/sync-manager.ts",
  "src/utils/performance-benchmarks.ts",
  "src/utils/exportUtils.ts",
  "src/utils/file-system-bridge.ts",
  "src/utils/officeDocumentProcessor.ts",
  "src/db/DatabaseContext.tsx",
  "src/db/NativeAPIClient.ts",
  "src/db/PerformanceMonitor.ts",
  "src/db/QueryTranslation.ts",
  "src/db/fts5-maintenance.ts",
  "src/db/migration-safety.ts",
  "src/dsl/compiler.ts",
  "src/filters/compiler.ts",
  "eslint.config.js"
]
autonomous: true

must_haves:
  truths:
    - "npm run lint returns '✖ 0 problems (0 errors, 0 warnings)'"
    - "All 19 remaining lint errors completely eliminated"
    - "All 186 remaining lint warnings completely eliminated"
    - "ESLint config properly handles mixed environments (Node.js/Browser)"
    - "Zero no-explicit-any warnings remain in codebase"
    - "Zero unused variable warnings remain in codebase"
    - "All case declaration block errors resolved"
  artifacts:
    - path: "eslint.config.js"
      provides: "Complete ESLint flat config for mixed environments"
      contains: "overrides.*node.*browser"
    - path: "src/server/launch-native-server.js"
      provides: "Properly configured Node.js globals"
      contains: "/* eslint-env node */"
    - path: "src/hooks/useClaudeAPI.ts"
      provides: "Complete type safety without any types"
      exports: ["useClaudeAPI"]
      min_lines: 50
    - path: "src/utils/migration-validator.ts"
      provides: "Fixed case declarations with block scope"
      contains: "case.*{"
  key_links:
    - from: "eslint.config.js"
      to: "Node.js file environment"
      via: "environment overrides"
      pattern: "files.*server.*env.*node"
    - from: "all TypeScript files"
      to: "proper type definitions"
      via: "no any types"
      pattern: "interface.*(?!any)"
    - from: "case statements"
      to: "block scope"
      via: "lexical declarations"
      pattern: "case.*{.*const|let"
---

<objective>
Achieve absolute zero lint problems (205 → 0) through systematic elimination of all remaining errors and warnings, complete type safety implementation, and comprehensive ESLint configuration for production deployment.

Purpose: Complete the lint cleanup journey to production-ready code quality standards required for App Store submission, enabling clean builds with zero tolerance for errors or warnings across the entire codebase.
Output: Codebase with exactly 0 lint problems, comprehensive type safety, proper environment configuration, and production-ready quality.
</objective>

<execution_context>
@/Users/mshaler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mshaler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-error-elimination/09-06-SUMMARY.md

# Current status: 205 problems (19 errors, 186 warnings)
# Error breakdown: 11 no-case-declarations, 8 no-redeclare/no-undef
# Warning breakdown: ~110 no-explicit-any, ~76 no-unused-vars
# Critical systems: Server config, hooks, utils, database layer
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix ESLint configuration and Node.js environment errors</name>
  <files>eslint.config.js, src/server/launch-native-server.js</files>
  <action>
    Complete the ESLint configuration to properly handle mixed Node.js/browser environments and eliminate all global variable redeclaration errors:

    1. **Fix eslint.config.js for flat config:**
       ```javascript
       export default [
         // Base TypeScript config
         {
           files: ['src/**/*.{ts,tsx}'],
           languageOptions: {
             parser: '@typescript-eslint/parser',
             parserOptions: {
               ecmaVersion: 'latest',
               sourceType: 'module',
               ecmaFeatures: { jsx: true }
             }
           },
           plugins: {
             '@typescript-eslint': require('@typescript-eslint/eslint-plugin')
           },
           rules: {
             // existing rules
           }
         },
         // Node.js server files
         {
           files: ['src/server/**/*.js'],
           languageOptions: {
             globals: {
               console: 'readonly',
               process: 'readonly',
               Buffer: 'readonly',
               __dirname: 'readonly',
               __filename: 'readonly',
               require: 'readonly',
               module: 'readonly',
               exports: 'readonly'
             }
           }
         }
       ];
       ```

    2. **Fix src/server/launch-native-server.js:**
       - Remove duplicate global declarations (lines causing no-redeclare errors)
       - Add proper `/* eslint-env node */` at top
       - Remove unused variable declarations (__dirname, __filename if unused)

    This eliminates 8 no-redeclare/no-undef errors and establishes proper environment configuration.
  </action>
  <verify>npm run lint src/server/launch-native-server.js 2>&1 | grep -E "(no-redeclare|no-undef)" | wc -l should return 0</verify>
  <done>ESLint properly configured for mixed environments, all global redeclaration errors eliminated</done>
</task>

<task type="auto">
  <name>Task 2: Fix all case declaration block errors</name>
  <files>src/hooks/useNotebookIntegration.ts, src/utils/list-grouping.ts, src/utils/migration-validator.ts</files>
  <action>
    Systematically fix all 11 no-case-declarations errors by adding proper block scope to switch case statements:

    1. **src/hooks/useNotebookIntegration.ts (line 231):**
       ```typescript
       case 'some-case': {
         const someVariable = someValue; // lexical declaration now properly scoped
         // ... rest of case logic
         break;
       }
       ```

    2. **src/utils/list-grouping.ts (lines 138, 145):**
       - Wrap case contents with block scope `{ }`
       - Ensure all `const` and `let` declarations are within blocks

    3. **src/utils/migration-validator.ts (lines 197, 207, 216, 225):**
       - Add block scope to all case statements with variable declarations
       - Maintain existing logic while fixing scope issues

    Pattern: Every case statement with `const` or `let` declarations must be wrapped in `{ }` block scope.
  </action>
  <verify>npm run lint 2>&1 | grep "no-case-declarations" | wc -l should return 0</verify>
  <done>All case declaration block scope errors eliminated with proper lexical scoping</done>
</task>

<task type="auto">
  <name>Task 3: Comprehensive elimination of no-explicit-any warnings</name>
  <files>src/hooks/useClaudeAPI.ts, src/hooks/useNotebookIntegration.ts, src/hooks/useNotebookPerformance.ts, src/utils/filter-presets.ts, src/utils/sync-manager.ts, src/utils/performance-benchmarks.ts, src/utils/migration-validator.ts, src/db/fts5-maintenance.ts, src/db/migration-safety.ts, src/dsl/compiler.ts</files>
  <action>
    Replace all ~110 'any' types with proper TypeScript interfaces, building comprehensive type safety:

    **1. Hook Type Safety:**
    - **useClaudeAPI.ts**: Replace `any` (lines 30, 60) with proper ClaudeResponse interface
    - **useNotebookIntegration.ts**: Replace `any` (lines 36, 37, 177, 231) with NotebookAction interfaces
    - **useNotebookPerformance.ts**: Replace `any` (line 129) with PerformanceMetrics interface

    **2. Utility Type Safety:**
    - **filter-presets.ts**: Replace `any` (line 26) with FilterValue union type
    - **sync-manager.ts**: Replace `any` (lines 221, 445) with SyncOperation interfaces
    - **performance-benchmarks.ts**: Replace `any` (line 535) with BenchmarkResult interface
    - **migration-validator.ts**: Replace all `any` types (lines 57-66) with ValidationResult interfaces

    **3. Database Type Safety:**
    - **fts5-maintenance.ts**: Replace `any` (line 3) with FTS5Config interface
    - **migration-safety.ts**: Replace `any` (line 573) with MigrationStep interface
    - **dsl/compiler.ts**: Replace `any` (lines 50, 68) with DSLNode interfaces

    **Strategic approach:** Create specific interfaces for each domain (Claude, Notebook, Performance, etc.) rather than using `unknown` to maintain type safety while enabling proper IntelliSense.
  </action>
  <verify>npm run lint 2>&1 | grep "no-explicit-any" | wc -l should return 0</verify>
  <done>Complete type safety achieved with zero 'any' types and comprehensive interface coverage</done>
</task>

<task type="auto">
  <name>Task 4: Systematic unused variable cleanup</name>
  <files>src/db/DatabaseContext.tsx, src/db/NativeAPIClient.ts, src/db/PerformanceMonitor.ts, src/db/QueryTranslation.ts, src/hooks/useNodeTree.ts, src/hooks/useOptimizedQueries.ts, src/hooks/useSQLiteQuery.ts, src/hooks/useWebPreview.ts, src/hooks/useFileSystem.ts, src/utils/exportUtils.ts, src/utils/file-system-bridge.ts, src/utils/officeDocumentProcessor.ts, src/filters/compiler.ts, src/db/migration-safety.ts, src/utils/migration-validator.ts</files>
  <action>
    Systematically eliminate all ~76 no-unused-vars warnings using established patterns from Phase 09:

    **1. Database Layer Cleanup:**
    - DatabaseContext.tsx: Remove unused 'createContext' import (line 1)
    - NativeAPIClient.ts: Prefix '_error' with underscore (line 43)
    - PerformanceMonitor.ts: Handle '_successfulOperations', '_testData' (lines 152, 357)
    - QueryTranslation.ts: Handle '_complexityScore' (line 122)

    **2. Hook Cleanup:**
    - useNodeTree.ts: Handle 'visited', 'nodeMap' variables (lines 55, 101)
    - useOptimizedQueries.ts: Remove unused 'TranslationResult', handle 'dependencies' (lines 10, 406)
    - useSQLiteQuery.ts: Remove unused 'TranslationResult' import (line 4)
    - useWebPreview.ts: Handle 'mergedOptions' (line 36)
    - useFileSystem.ts: Remove unused 'ExportFormat' (line 12)

    **3. Utility Cleanup:**
    - exportUtils.ts: Handle 'includeMetadata', 'multipleSheets' (lines 434, 435)
    - file-system-bridge.ts: Prefix unused parameters (lines 199, 224, 248, 296)
    - officeDocumentProcessor.ts: Handle '_textResult', '_metadataRange' (lines 273, 497)

    **4. Migration/Filter Cleanup:**
    - filters/compiler.ts: Handle '_e' (line 185)
    - migration-safety.ts: Prefix unused parameters throughout file
    - migration-validator.ts: Prefix all unused parameters with underscore

    **Pattern:** Remove unused imports, prefix required but unused parameters with '_', remove truly unused variables.
  </action>
  <verify>npm run lint 2>&1 | grep "no-unused-vars" | wc -l should return 0</verify>
  <done>Zero unused variable warnings with proper naming conventions and clean imports</done>
</task>

</tasks>

<verification>
Absolute zero lint problems verification:

1. **Complete Elimination Check:**
   ```bash
   npm run lint
   # Expected output: "✖ 0 problems (0 errors, 0 warnings)"
   ```

2. **Category-Specific Verification:**
   ```bash
   npm run lint 2>&1 | grep "no-explicit-any" | wc -l     # Should be 0
   npm run lint 2>&1 | grep "no-unused-vars" | wc -l      # Should be 0
   npm run lint 2>&1 | grep "no-case-declarations" | wc -l # Should be 0
   npm run lint 2>&1 | grep "no-redeclare" | wc -l        # Should be 0
   npm run lint 2>&1 | grep "no-undef" | wc -l            # Should be 0
   ```

3. **Test Suite Integrity:**
   ```bash
   npm run test
   # Expected: All 471 tests passing (no regressions from type changes)
   ```

4. **TypeScript Compilation:**
   ```bash
   npm run typecheck
   # Expected: Zero TypeScript compilation errors
   ```

5. **Build Verification:**
   ```bash
   npm run build
   # Expected: Clean build with no errors or warnings
   ```

6. **Production Readiness Check:**
   ```bash
   npm run build:production 2>&1 | grep -i "warning\|error" | wc -l
   # Expected: 0 (completely clean production build)
   ```
</verification>

<success_criteria>
**Primary Success Criteria:**
1. **Absolute Zero Problems:** `npm run lint` reports "✖ 0 problems (0 errors, 0 warnings)"
2. **Complete Error Elimination:** All 19 remaining errors resolved
3. **Complete Warning Elimination:** All 186 remaining warnings resolved
4. **Production Build Clean:** Zero warnings in production build
5. **Type Safety Complete:** Zero 'any' types in production code paths
6. **Test Suite Integrity:** All 471 tests continue passing

**Quality Metrics:**
- **Before:** 205 problems (19 errors, 186 warnings)
- **After:** 0 problems (0 errors, 0 warnings)
- **Error Categories:** no-case-declarations (11→0), no-redeclare/no-undef (8→0)
- **Warning Categories:** no-explicit-any (~110→0), no-unused-vars (~76→0)
- **Type Safety:** Complete interface coverage with zero any types
- **Code Quality:** Production-ready with App Store compliance

**Production Readiness Validation:**
- ESLint configuration handles all environments (Node.js, Browser, TypeScript)
- Complete type safety enables advanced IDE features and refactoring safety
- Zero build warnings meet App Store submission requirements
- Comprehensive cleanup enables future development with confidence
- All systems maintain functionality while achieving strict quality standards

**Achievement Impact:**
- **Development Quality:** Clean codebase with comprehensive type safety
- **Maintenance:** Zero technical debt from lint issues
- **Production:** App Store submission ready
- **Team Productivity:** Clean development environment with no distracting warnings
</success_criteria>

<output>
After completion, create `.planning/phases/10-foundation-cleanup/10-01-SUMMARY.md` documenting the achievement of absolute zero lint problems and comprehensive production readiness.
</output>