---
phase: 10-foundation-cleanup
plan: 07
type: execute
wave: 1
depends_on: []
files_modified: [
  "src/components/notebook/CaptureComponent.tsx",
  "src/components/notebook/PropertyEditor.tsx",
  "src/components/ui/ErrorBoundary.tsx",
  "src/db/WebViewClient.ts",
  "src/db/WebViewDatabaseContext.tsx",
  "src/services/ErrorReportingService.ts",
  "src/utils/officeDocumentProcessor.ts"
]
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "npm run lint returns 'âœ– 0 problems (0 errors, 0 warnings)'"
    - "Zero explicit 'any' type annotations remain in main source files"
    - "Event handlers use proper TypeScript interfaces instead of any"
  artifacts:
    - path: "src/components/notebook/CaptureComponent.tsx"
      provides: "Type-safe event handlers without any annotations"
      min_lines: 200
    - path: "src/components/notebook/PropertyEditor.tsx"
      provides: "Type-safe property editing without any types"
      min_lines: 300
    - path: "src/utils/officeDocumentProcessor.ts"
      provides: "Document processing with proper type interfaces"
      min_lines: 700
  key_links:
    - from: "Event handlers"
      to: "React event types"
      via: "React.ChangeEvent, React.FormEvent interfaces"
      pattern: "React\\.(ChangeEvent|FormEvent|MouseEvent)"
    - from: "Document processing functions"
      to: "Type interfaces"
      via: "Proper interface definitions"
      pattern: "interface.*\\{[^}]+\\}"
---

<objective>
Eliminate all explicit 'any' type annotations from main source files to achieve absolute zero ESLint warnings

Purpose: Complete the Phase 10 foundation cleanup goal by removing the remaining 37 explicit 'any' types that are blocking zero-warning achievement
Output: Clean source files with proper TypeScript interfaces, eliminating 37 of 53 ESLint warnings
</objective>

<execution_context>
@/Users/mshaler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mshaler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-foundation-cleanup/10-06-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace explicit 'any' types in notebook components</name>
  <files>src/components/notebook/CaptureComponent.tsx, src/components/notebook/PropertyEditor.tsx</files>
  <action>
    Replace all explicit 'any' type annotations in CaptureComponent.tsx and PropertyEditor.tsx with proper TypeScript interfaces:

    CaptureComponent.tsx (6 locations):
    - Line 49: onChange handler - use React.ChangeEvent<HTMLTextAreaElement>
    - Line 50: event parameter - use React.ChangeEvent<HTMLTextAreaElement>
    - Line 59: onKeyDown handler - use React.KeyboardEvent<HTMLTextAreaElement>
    - Line 61: event parameter - use React.KeyboardEvent<HTMLTextAreaElement>
    - Line 70: onClick handler - use React.MouseEvent<HTMLButtonElement>
    - Line 72: event parameter - use React.MouseEvent<HTMLButtonElement>

    PropertyEditor.tsx (5 locations):
    - Line 318: onChange handler - use React.ChangeEvent<HTMLInputElement>
    - Line 319: event parameter - use React.ChangeEvent<HTMLInputElement>
    - Line 328: onKeyDown handler - use React.KeyboardEvent<HTMLInputElement>
    - Line 330: event parameter - use React.KeyboardEvent<HTMLInputElement>
    - Line 337: onBlur handler - use React.FocusEvent<HTMLInputElement>

    Reference existing patterns from other components for consistent React event typing.
  </action>
  <verify>npm run lint src/components/notebook/ should show 0 explicit-any warnings for these files</verify>
  <done>CaptureComponent.tsx and PropertyEditor.tsx have no remaining @typescript-eslint/no-explicit-any warnings</done>
</task>

<task type="auto">
  <name>Task 2: Replace explicit 'any' types in utility and service files</name>
  <files>src/components/ui/ErrorBoundary.tsx, src/db/WebViewClient.ts, src/services/ErrorReportingService.ts, src/utils/officeDocumentProcessor.ts</files>
  <action>
    Replace explicit 'any' type annotations with proper interfaces:

    ErrorBoundary.tsx (2 locations):
    - Line 54: componentDidCatch handler - use Error type for error parameter
    - Line 55: errorInfo parameter - use React.ErrorInfo type

    WebViewClient.ts (1 location):
    - Line 25: message handler - create MessageEvent interface with required properties

    ErrorReportingService.ts (1 location):
    - Line 79: error parameter - use Error | unknown type union

    officeDocumentProcessor.ts (8 locations):
    - Lines 298, 301: Create DocumentStyle interface for CSS style objects
    - Lines 635, 667, 668: Create ParsedElement interface for document elements
    - Lines 700, 701: Create TableData interface for table parsing results

    Create proper interface definitions at the top of each file where needed.
    Gap reason: Explicit any types breaking type safety goal and generating ESLint warnings.
  </action>
  <verify>npm run lint on these specific files should show 0 explicit-any warnings</verify>
  <done>All utility and service files have proper TypeScript interfaces replacing explicit 'any' annotations</done>
</task>

</tasks>

<verification>
Run npm run lint to confirm ESLint warning count reduced from 53 to ~37 (16 explicit-any warnings eliminated)
</verification>

<success_criteria>
- ESLint explicit-any warnings reduced by 16 (from 37 to 21 remaining)
- Main source files (components, services, utilities) use proper TypeScript interfaces
- Event handlers follow React TypeScript patterns consistently
- Document processing functions have typed interfaces instead of any
</success_criteria>

<output>
After completion, create `.planning/phases/10-foundation-cleanup/10-07-SUMMARY.md`
</output>