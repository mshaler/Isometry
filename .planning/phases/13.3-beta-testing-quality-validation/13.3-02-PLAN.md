---
phase: 13.3
plan: 02
type: execute
wave: 2
depends_on: ["13.3-01"]
files_modified: [
  "native/Sources/Isometry/Monitoring/ProductionMonitoringDashboard.swift",
  "native/Sources/Isometry/Analytics/ProductionAnalytics.swift",
  "native/Sources/Isometry/Beta/BetaTestingManager.swift",
  "native/Tests/IsometryTests/ProductionVerification/CloudKitProductionVerificationTests.swift",
  ".planning/phases/13.3-beta-testing-quality-validation/13.3-02-TEST-PLAN.md"
]
autonomous: false

must_haves:
  truths:
    - "Production monitoring and analytics are active in beta builds"
    - "Crash/error reporting and alerting are validated"
    - "Beta feedback is captured and categorized"
  artifacts:
    - path: ".planning/phases/13.3-beta-testing-quality-validation/13.3-02-TEST-PLAN.md"
      provides: "Beta testing validation plan and coverage matrix"
      min_lines: 30
  key_links:
    - from: "native/Sources/Isometry/Monitoring/ProductionMonitoringDashboard.swift"
      to: "Production metrics collection"
      via: "ProductionMetricsCollector"
      pattern: "ProductionMetricsCollector"
    - from: "native/Sources/Isometry/Analytics/ProductionAnalytics.swift"
      to: "Beta analytics tracking"
      via: "BetaAnalyticsEvent"
      pattern: "Beta"
---

<objective>
Validate monitoring, analytics, and beta feedback flows in TestFlight builds.
</objective>

<context>
@.planning/STATE.md
@.planning/milestones/v3.0-production-deployment/REQUIREMENTS.md
@native/Sources/Isometry/Monitoring/ProductionMonitoringDashboard.swift
@native/Sources/Isometry/Analytics/ProductionAnalytics.swift
@native/Sources/Isometry/Beta/BetaTestingManager.swift
@native/Tests/IsometryTests/ProductionVerification/CloudKitProductionVerificationTests.swift
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create beta validation test plan</name>
  <files>
    .planning/phases/13.3-beta-testing-quality-validation/13.3-02-TEST-PLAN.md
  </files>
  <action>
    Create a concise test plan for beta validation covering:
    - Monitoring metrics capture
    - Crash/error reporting pipeline
    - Analytics consent and event capture
    - Beta feedback UI and data submission
    - CloudKit production telemetry checks
    Include acceptance criteria aligned to CLOUD-03, BETA-01, BETA-02.
  </action>
  <verify>
    rg -n "CLOUD-03" .planning/phases/13.3-beta-testing-quality-validation/13.3-02-TEST-PLAN.md
  </verify>
  <done>Beta validation test plan exists with coverage mapping</done>
</task>

<task type="auto">
  <name>Task 2: Wire test hooks for monitoring/analytics verification</name>
  <files>
    native/Sources/Isometry/Monitoring/ProductionMonitoringDashboard.swift
    native/Sources/Isometry/Analytics/ProductionAnalytics.swift
  </files>
  <action>
    Ensure there are explicit lightweight hooks/log points that can be observed in beta builds (e.g., logs emitted when metrics collection starts, analytics consent toggled, and telemetry flush occurs). Avoid altering core behavior; add minimal logging or exposed flags if missing.
  </action>
  <verify>
    rg -n "monitoring" native/Sources/Isometry/Monitoring/ProductionMonitoringDashboard.swift
    rg -n "analytics" native/Sources/Isometry/Analytics/ProductionAnalytics.swift
  </verify>
  <done>Monitoring and analytics hooks are observable during beta testing</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Beta monitoring, analytics, and feedback validation plan with observable hooks</what-built>
  <how-to-verify>
    1) Install TestFlight build and run through a beta session
    2) Confirm monitoring logs for app launch, CloudKit sync, and performance metrics
    3) Toggle analytics consent and verify event capture in logs or dashboard
    4) Submit beta feedback and confirm data is persisted
    5) Review CloudKit production telemetry for activity
  </how-to-verify>
  <resume-signal>Type "beta-validation-complete" when all validation steps pass</resume-signal>
</task>

</tasks>

<verification>
- Run targeted validation from 13.3-02-TEST-PLAN.md
</verification>

<success_criteria>
- Monitoring/analytics visible in beta builds
- Feedback collection works end-to-end
- CloudKit telemetry reflects beta usage
</success_criteria>
