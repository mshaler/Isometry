---
phase: 35-pafv-grid-core
plan: 07
type: execute
wave: 2
depends_on: [35-06]
files_modified: [
  src/components/SuperGridView.tsx,
  src/types/supergrid.ts,
  src/components/supergrid/SuperDensity.tsx,
  src/components/VirtualizedGrid/index.tsx,
  src/hooks/performance/useVirtualizedGrid.ts,
  src/components/SuperZoomControls.tsx,
  src/utils/coordinate-system/coordinates.ts,
  src/components/supergrid/AdvancedSuperGridDemo.tsx,
  src/services/LATCHFilterService.ts
]
autonomous: true

must_haves:
  truths:
    - "SuperGrid component interfaces match their type definitions"
    - "JanusDensityState interface includes all required properties"
    - "Virtual grid integration uses correct API signatures"
    - "CoordinateSystem types align with D3 visualization requirements"
    - "LATCH filter interfaces match actual filter data structures"
  artifacts:
    - path: "src/types/supergrid.ts"
      provides: "Complete JanusDensityState interface"
      contains: "extentMode, valueMode, zoomLevel, panOffset"
    - path: "src/components/SuperGridView.tsx"
      provides: "Working SuperGrid component with proper type usage"
      min_lines: 200
    - path: "src/utils/coordinate-system/coordinates.ts"
      provides: "D3CoordinateSystem interface alignment"
      exports: ["D3CoordinateSystem", "CoordinateSystem"]
  key_links:
    - from: "src/components/SuperGridView.tsx"
      to: "src/types/supergrid.ts"
      via: "JanusDensityState interface"
      pattern: "extentMode.*valueMode.*zoomLevel.*panOffset"
    - from: "src/components/VirtualizedGrid/index.tsx"
      to: "src/hooks/performance/useVirtualizedGrid.ts"
      via: "virtualItems API"
      pattern: "virtualItems.*not.*virtualGridItems"
---

<objective>
Complete TypeScript type alignment for SuperGrid core interfaces and virtualization.

Purpose: Ensure SuperGrid components have proper type definitions for production stability
Output: Type-safe SuperGrid implementation with proper interface definitions
</objective>

<execution_context>
@/Users/mshaler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mshaler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# SuperGrid type system from previous implementation
@.planning/phases/35-pafv-grid-core/35-05-SUMMARY.md
@.planning/phases/36-supergrid-headers/36-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Fix SuperGrid Type Interfaces</name>
  <files>
    src/types/supergrid.ts
    src/components/SuperGridView.tsx
    src/components/supergrid/SuperDensity.tsx
  </files>
  <action>
    Fix SuperGrid type interface mismatches by:
    1. Update JanusDensityState interface in types/supergrid.ts to include: extentMode, valueMode, zoomLevel, panOffset
    2. Fix SuperGridView.tsx property access to match the updated interface
    3. Align SuperDensity.tsx query method signature with expected Database service interface
    4. Ensure CoordinateSystem vs D3CoordinateSystem types are properly defined and used
    5. Reference existing Phase 36 header implementation for type patterns

    Apply structural fixes: update interface definitions to match actual usage patterns.
  </action>
  <verify>npm run check:types 2>&1 | grep -E "(extentMode|valueMode|zoomLevel|panOffset|D3CoordinateSystem)" | wc -l</verify>
  <done>SuperGrid type interfaces properly aligned with implementation, JanusDensityState complete</done>
</task>

<task type="auto">
  <name>Fix Virtual Grid Integration Types</name>
  <files>
    src/components/VirtualizedGrid/index.tsx
    src/hooks/performance/useVirtualizedGrid.ts
  </files>
  <action>
    Fix virtual grid type integration by:
    1. Update VirtualizedGrid to use correct TanStack Virtual API (virtualItems not virtualGridItems)
    2. Fix useVirtualizedGrid hook parameter signature to match TanStack Virtual v3 API
    3. Align virtualization result types with actual TanStack return values
    4. Reference Phase 34-02 implementation for correct TanStack Virtual usage patterns
    5. Ensure virtualization integrates properly with SuperGrid density controls

    Apply API alignment fixes: match TanStack Virtual v3 interface requirements.
  </action>
  <verify>npm run check:types 2>&1 | grep -E "(virtualGridItems|virtualItems)" | wc -l</verify>
  <done>Virtual grid integration uses correct TanStack Virtual API, type signatures aligned</done>
</task>

<task type="auto">
  <name>Fix Filter and Component Type Mismatches</name>
  <files>
    src/components/supergrid/AdvancedSuperGridDemo.tsx
    src/services/LATCHFilterService.ts
    src/components/SuperZoomControls.tsx
  </files>
  <action>
    Fix filter and component type mismatches by:
    1. Update AdvancedSuperGridDemo to use complete LATCHFilter interface with id, facet, timestamp
    2. Remove unused BoundaryConstraints type declaration from SuperZoomControls
    3. Ensure LATCHFilter interface consistency between service and components
    4. Reference Phase 35-02 LATCH filter implementation for correct interface usage
    5. Verify type consistency across all filter-related components

    Apply interface completion: add missing required properties to match service expectations.
  </action>
  <verify>npm run check:types 2>&1 | grep -E "(LATCHFilter|BoundaryConstraints)" | wc -l</verify>
  <done>Filter interfaces properly defined, unused types removed, component type consistency achieved</done>
</task>

</tasks>

<verification>
Run `npm run check:types` and verify:
1. Zero TypeScript compilation errors for SuperGrid components
2. JanusDensityState interface complete with all required properties
3. TanStack Virtual integration uses correct API
4. Filter interfaces consistent across components
5. No unused type declarations remain
</verification>

<success_criteria>
1. SuperGrid component compiles without type errors
2. JanusDensityState interface includes extentMode, valueMode, zoomLevel, panOffset
3. Virtual grid integration matches TanStack Virtual v3 API
4. LATCHFilter interfaces are complete and consistent
5. Type system supports SuperGrid density controls and virtualization
</success_criteria>

<output>
After completion, create `.planning/phases/35-pafv-grid-core/35-07-SUMMARY.md`
</output>