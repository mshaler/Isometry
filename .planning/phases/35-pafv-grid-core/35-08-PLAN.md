---
phase: 35-pafv-grid-core
plan: 08
type: execute
wave: 3
depends_on: [35-07]
files_modified: [
  src/utils/database/migration-validator.ts,
  src/utils/database/query-builder.ts,
  src/utils/logging/logging-strategy.ts,
  src/utils/security/security-validator.ts,
  src/utils/transaction/rollback-manager.ts,
  src/contexts/EnvironmentContext.tsx,
  src/contexts/notebook/types.ts,
  src/contexts/NotebookContext.tsx,
  src/components/performance/PerformanceBaseline.tsx,
  src/components/performance/RenderingMetricsPanel.tsx,
  src/utils/d3-visualization/d3Testing.ts,
  src/utils/database/cache-invalidation.ts,
  src/utils/bridge-optimization/
]
autonomous: true

must_haves:
  truths:
    - "Module resolution errors are resolved with correct import paths"
    - "Database service interfaces are properly typed"
    - "Bridge optimization utilities have correct signatures"
    - "Performance monitoring interfaces match implementations"
    - "Security validators use proper module dependencies"
  artifacts:
    - path: "src/utils/database/migration-validator.ts"
      provides: "Working migration validator without module errors"
      imports_resolved: ["EnvironmentContext", "dev-logger"]
    - path: "src/utils/database/query-builder.ts"
      provides: "Properly typed query builder with LATCH filter support"
      min_lines: 100
    - path: "src/contexts/EnvironmentContext.tsx"
      provides: "Environment context with correct interface exports"
      exports: ["EnvironmentProvider", "useEnvironment"]
  key_links:
    - from: "src/utils/database/migration-validator.ts"
      to: "src/contexts/EnvironmentContext.tsx"
      via: "environment context import"
      pattern: "import.*EnvironmentContext"
    - from: "src/utils/database/query-builder.ts"
      to: "src/services/LATCHFilterService.ts"
      via: "filter compilation interface"
      pattern: "LATCHFilter.*FilterChip"
---

<objective>
Resolve remaining module resolution and dependency type errors for utility and service layers.

Purpose: Complete foundation stabilization by fixing module paths and service interfaces
Output: Clean utility layer with properly resolved dependencies and type-safe service interfaces
</objective>

<execution_context>
@/Users/mshaler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mshaler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Module resolution patterns from working components
@.planning/phases/40-foundation-stabilization/40-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Fix Module Resolution and Import Path Errors</name>
  <files>
    src/utils/database/migration-validator.ts
    src/utils/logging/logging-strategy.ts
    src/utils/security/security-validator.ts
    src/utils/d3-visualization/d3Testing.ts
    src/contexts/EnvironmentContext.tsx
  </files>
  <action>
    Fix module resolution and import path errors by:
    1. Update migration-validator.ts imports: fix EnvironmentContext path, add missing dev-logger
    2. Fix logging-strategy.ts import path for logging/logger module
    3. Update security-validator.ts imports: resolve missing security modules or stub them properly
    4. Fix d3Testing.ts dev-logger import path to match established pattern
    5. Ensure EnvironmentContext.tsx exports match expected interface (isNative, platform, version)
    6. Apply local resolution pattern from Phase 40-01: prefer relative imports over cross-module

    Follow CLAUDE.md boundary compliance: fix imports without changing module architecture.
  </action>
  <verify>npm run check:types 2>&1 | grep -E "Cannot find module" | wc -l</verify>
  <done>All module resolution errors fixed, import paths properly resolved</done>
</task>

<task type="auto">
  <name>Fix Database Service Type Interfaces</name>
  <files>
    src/utils/database/query-builder.ts
    src/utils/database/cache-invalidation.ts
    src/utils/transaction/rollback-manager.ts
  </files>
  <action>
    Fix database service type interfaces by:
    1. Update query-builder.ts: properly type LATCH filter chip arrays with correct FilterChip interface
    2. Fix parameter type annotations (remove implicit 'any' types)
    3. Update cache-invalidation.ts: remove unused variables and fix key parameter typing
    4. Fix rollback-manager.ts: correct function signatures to match Database service API
    5. Reference existing DatabaseService.ts for correct typing patterns

    Apply type completion: add explicit types to remove 'any' annotations.
  </action>
  <verify>npm run check:types 2>&1 | grep -E "(implicit.*any|Parameter.*any)" | wc -l</verify>
  <done>Database service interfaces properly typed, no implicit 'any' types remain</done>
</task>

<task type="auto">
  <name>Fix Performance and Context Type Mismatches</name>
  <files>
    src/contexts/notebook/types.ts
    src/contexts/NotebookContext.tsx
    src/components/performance/PerformanceBaseline.tsx
    src/components/performance/RenderingMetricsPanel.tsx
    src/utils/bridge-optimization/
  </files>
  <action>
    Fix performance and context type mismatches by:
    1. Update notebook/types.ts: fix NotebookIntegrationState import from hooks
    2. Fix NotebookContext.tsx: add missing averageTransitionTime to PerformanceMetrics
    3. Update PerformanceBaseline.tsx: correct function parameter count for performance API
    4. Fix RenderingMetricsPanel.tsx: add recommendation property to SimpleAlert interface
    5. Clean up bridge-optimization utilities: remove unused parameters and fix callback signatures
    6. Reference Phase 34-01 error telemetry implementation for performance interface patterns

    Apply interface completion: align interfaces with actual implementations.
  </action>
  <verify>npm run check:types 2>&1 | grep -E "(NotebookIntegrationState|averageTransitionTime|recommendation)" | wc -l</verify>
  <done>Performance and context interfaces aligned, type mismatches resolved</done>
</task>

</tasks>

<verification>
Run `npm run check:types` and verify:
1. Zero module resolution errors ("Cannot find module")
2. No implicit 'any' type errors
3. All interface mismatches resolved
4. Database service types properly defined
5. Performance monitoring interfaces complete
</verification>

<success_criteria>
1. All module imports resolve correctly without path errors
2. Database utility interfaces are properly typed
3. Performance monitoring has complete interface definitions
4. Bridge optimization utilities compile without errors
5. TypeScript error count significantly reduced from initial 334 count
</success_criteria>

<output>
After completion, create `.planning/phases/35-pafv-grid-core/35-08-SUMMARY.md`
</output>