---
phase: 06.1-foundation-layout
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [
  "native/Sources/Isometry/Views/Notebook/NotebookContentView.swift",
  "native/Sources/Isometry/Models/NotebookLayoutModel.swift",
  "native/Sources/Isometry/Views/Notebook/NotebookCaptureView.swift",
  "native/Sources/Isometry/Views/Notebook/NotebookShellView.swift",
  "native/Sources/Isometry/Views/Notebook/NotebookPreviewView.swift"
]
autonomous: true

must_haves:
  truths:
    - "User can access notebook mode and see three-component layout"
    - "Layout automatically adapts between desktop/tablet/mobile screen sizes"
    - "User can resize component widths by dragging dividers on desktop"
    - "Layout state persists across app sessions"
  artifacts:
    - path: "native/Sources/Isometry/Views/Notebook/NotebookContentView.swift"
      provides: "SwiftUI three-component layout container"
      min_lines: 200
    - path: "native/Sources/Isometry/Models/NotebookLayoutModel.swift"
      provides: "Layout state management and persistence"
      exports: ["NotebookLayoutModel", "ComponentLayout"]
    - path: "native/Sources/Isometry/Views/Notebook/NotebookCaptureView.swift"
      provides: "Capture component shell"
      contains: "struct NotebookCaptureView"
  key_links:
    - from: "NotebookContentView"
      to: "NotebookLayoutModel"
      via: "@StateObject layout binding"
      pattern: "@StateObject.*NotebookLayoutModel"
    - from: "NotebookContentView"
      to: "UserDefaults"
      via: "layout persistence"
      pattern: "\.onAppear.*UserDefaults"
---

<objective>
Create responsive three-component SwiftUI layout that matches React prototype functionality with native performance optimizations.

Purpose: Establish the foundation layout infrastructure that will host capture, shell, and preview components for notebook workflow
Output: Working SwiftUI layout with responsive design, resizable components, and state persistence
</objective>

<execution_context>
@/Users/mshaler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mshaler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@native/Sources/Isometry/App/ContentView.swift
@src/components/notebook/NotebookLayout.tsx
@native/Sources/Isometry/Views/SuperGridView.swift
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create NotebookLayoutModel for state management</name>
  <files>native/Sources/Isometry/Models/NotebookLayoutModel.swift</files>
  <action>
    Create ObservableObject class NotebookLayoutModel that manages:
    - ComponentLayout struct with width/height percentages for capture/shell/preview
    - ScreenSize enum (.mobile, .tablet, .desktop) with breakpoints matching React prototype
    - Layout persistence to UserDefaults with key "NotebookLayout"
    - Methods: updateComponentWidth(), resetToDefaults(), calculateLayout(for screenSize)
    - Default desktop layout: capture 40%, shell 30%, preview 30%
    - Mobile/tablet layouts with appropriate stacking

    Import Foundation, SwiftUI, Combine for reactive updates.
    Make thread-safe with @MainActor since it updates UI.
  </action>
  <verify>Build compiles without errors, NotebookLayoutModel conforms to ObservableObject</verify>
  <done>NotebookLayoutModel exists with state management and persistence methods</done>
</task>

<task type="auto">
  <name>Task 2: Create three-component shell views</name>
  <files>native/Sources/Isometry/Views/Notebook/NotebookCaptureView.swift, native/Sources/Isometry/Views/Notebook/NotebookShellView.swift, native/Sources/Isometry/Views/Notebook/NotebookPreviewView.swift</files>
  <action>
    Create three component shell views that will be populated in later phases:

    NotebookCaptureView:
    - Text("Capture Component - Markdown Editor") with .secondary foreground
    - Card background with rounded corners and shadow
    - Placeholder for markdown editor integration

    NotebookShellView:
    - Text("Shell Component - Terminal") with .secondary foreground
    - Card background with dark theme hint (terminal-like)
    - Placeholder for terminal integration

    NotebookPreviewView:
    - Text("Preview Component - Content Viewer") with .secondary foreground
    - Card background matching app theme
    - Placeholder for preview integration

    All views: Import SwiftUI, add padding, use consistent styling with existing app theme.
  </action>
  <verify>All three view files build and display placeholder content with proper styling</verify>
  <done>Three shell component views exist with consistent styling and placeholders</done>
</task>

<task type="auto">
  <name>Task 3: Create NotebookContentView with responsive layout</name>
  <files>native/Sources/Isometry/Views/Notebook/NotebookContentView.swift</files>
  <action>
    Create NotebookContentView that implements three-component layout:

    Structure:
    - @StateObject private var layout = NotebookLayoutModel()
    - @State private var screenSize: ScreenSize = .desktop
    - GeometryReader to detect screen size changes
    - Switch on screenSize for different layouts

    Desktop layout:
    - HStack with three components side-by-side
    - Resizable dividers using DragGesture (match React prototype drag behavior)
    - Min widths: capture 300pts, shell/preview 250pts each
    - Store drag state and update layout model on drag end

    Tablet layout:
    - VStack with capture on top (flex 1), HStack below with shell/preview (flex 1 each)

    Mobile layout:
    - VStack with all three components stacked vertically (equal heights)

    Screen size detection:
    - Use GeometryReader width: <768 = mobile, <1024 = tablet, >=1024 = desktop
    - Match React prototype breakpoints exactly

    Import SwiftUI. Use NavigationView structure similar to existing ContentView.
  </action>
  <verify>NotebookContentView builds and displays correct layout for different screen sizes</verify>
  <done>NotebookContentView provides responsive three-component layout matching React prototype behavior</done>
</task>

</tasks>

<verification>
1. Build native project: `cd native && xcodebuild -scheme Isometry build`
2. Test responsive behavior by resizing Simulator windows
3. Verify layout persistence by changing layout and restarting app
4. Check all three components render with proper styling
</verification>

<success_criteria>
- NotebookContentView renders three distinct component areas
- Layout automatically adapts to screen size changes (mobile/tablet/desktop)
- Desktop layout supports drag-to-resize functionality for component widths
- Layout preferences persist across app restarts
- Component styling matches existing app theme consistency
</success_criteria>

<output>
After completion, create `.planning/phases/06.1-foundation-layout/06.1-01-SUMMARY.md`
</output>