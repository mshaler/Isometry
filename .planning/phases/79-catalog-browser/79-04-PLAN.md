---
phase: 79-catalog-browser
plan: 04
type: execute
wave: 1
depends_on: []
files_modified: [src/components/IntegratedLayout.tsx]
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Click any facet value to filter SuperGrid"
    - "Breadcrumb shows active filter path"
    - "CatalogBrowser visible in application sidebar"
    - "FilterBreadcrumb visible below command bar"
  artifacts:
    - path: "src/components/IntegratedLayout.tsx"
      provides: "Integrated layout with CatalogBrowser and FilterBreadcrumb"
      contains: ["import { CatalogBrowser, FilterBreadcrumb }", "<CatalogBrowser", "<FilterBreadcrumb"]
  key_links:
    - from: "IntegratedLayout.tsx"
      to: "src/components/catalog/CatalogBrowser.tsx"
      via: "import and render"
      pattern: "import.*CatalogBrowser.*catalog"
    - from: "IntegratedLayout.tsx"
      to: "src/components/catalog/FilterBreadcrumb.tsx"
      via: "import and render"
      pattern: "import.*FilterBreadcrumb.*catalog"
---

<objective>
Integrate CatalogBrowser and FilterBreadcrumb into IntegratedLayout.tsx to close verification gaps from Phase 79.

Purpose: The catalog browser components were fully implemented and tested but never added to the main application layout. Users cannot access the catalog browsing UI or see the filter breadcrumb.

Output: IntegratedLayout.tsx renders CatalogBrowser in a collapsible sidebar panel and FilterBreadcrumb below the command bar.
</objective>

<execution_context>
@/Users/mshaler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mshaler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/79-catalog-browser/79-VERIFICATION.md
@src/components/IntegratedLayout.tsx
@src/components/catalog/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add FilterBreadcrumb below command bar</name>
  <files>src/components/IntegratedLayout.tsx</files>
  <action>
    1. Add import at top of file:
       `import { FilterBreadcrumb } from './catalog';`

    2. Add FilterBreadcrumb row after the command bar section (after line ~485):
       - Create a new row with same panel styling: `h-8 ${panelBg} border-b ${borderColor}`
       - Add px-4 padding and center vertically with `flex items-center`
       - Render `<FilterBreadcrumb />` inside
       - The breadcrumb shows "All Cards" when no filters are active
       - When filters exist, it shows a navigable path with clear-all option

    Note: FilterBreadcrumb is already wired to FilterContext via useFilters hook.
    No additional props needed - it reads activeFilters internally.
  </action>
  <verify>
    - `npm run typecheck` passes
    - IntegratedLayout.tsx imports FilterBreadcrumb from './catalog'
    - FilterBreadcrumb renders between command bar and dataset switcher
  </verify>
  <done>FilterBreadcrumb visible below command bar showing "All Cards" or active filter path</done>
</task>

<task type="auto">
  <name>Task 2: Add CatalogBrowser as collapsible sidebar panel</name>
  <files>src/components/IntegratedLayout.tsx</files>
  <action>
    1. Add CatalogBrowser to the import from './catalog':
       `import { CatalogBrowser, FilterBreadcrumb } from './catalog';`

    2. Add state for sidebar collapse:
       `const [catalogOpen, setCatalogOpen] = useState(true);`

    3. Restructure the main content area (around line ~570-630):
       - Current: SuperGrid takes flex-1
       - New: Horizontal flex container with:
         a) Collapsible sidebar (left): CatalogBrowser with fixed width (e.g., w-64)
         b) Main area (right): SuperGrid taking flex-1

    4. Sidebar structure:
       ```tsx
       {/* Catalog Sidebar */}
       {catalogOpen && (
         <div className={`w-64 ${panelBg} border-r ${borderColor} overflow-y-auto`}>
           <div className="flex items-center justify-between px-3 py-2 border-b ${borderColor}">
             <span className={`text-xs font-medium ${textColor}`}>Catalog</span>
             <button
               type="button"
               onClick={() => setCatalogOpen(false)}
               className={`p-1 rounded hover:${isNeXTSTEP ? 'bg-[#3A3A3A]' : 'bg-gray-100'} ${mutedColor}`}
               title="Hide catalog"
             >
               <ChevronLeft className="w-4 h-4" />
             </button>
           </div>
           <CatalogBrowser />
         </div>
       )}
       ```

    5. Add toggle button when sidebar is closed:
       - Add to the left edge of the SuperGrid area or command bar area
       - Small button with ChevronRight icon to re-open sidebar

    6. Import ChevronLeft and ChevronRight from lucide-react (if not already imported)

    Note: CatalogBrowser is already wired to FilterContext and useFacetAggregates.
    Clicking folder/tag/status will call setCategory which updates activeFilters,
    which FilterBreadcrumb will reflect and SuperGrid will react to via FilterContext.
  </action>
  <verify>
    - `npm run typecheck` passes
    - IntegratedLayout.tsx imports CatalogBrowser
    - Sidebar renders with CatalogBrowser content (folders, tags, status)
    - Sidebar can be collapsed/expanded
    - SuperGrid still takes remaining space
  </verify>
  <done>CatalogBrowser visible in collapsible sidebar with FolderTree, TagCloud, and StatusChips</done>
</task>

</tasks>

<verification>
After completion:
1. Run `npm run typecheck` - must pass with zero errors
2. Run `npm run dev` and verify:
   - FilterBreadcrumb visible below command bar showing "All Cards"
   - CatalogBrowser visible in left sidebar
   - Click any folder in CatalogBrowser -> FilterBreadcrumb updates to show that folder
   - Click any tag -> FilterBreadcrumb shows tag
   - Click Clear All in breadcrumb -> returns to "All Cards"
3. Sidebar collapse/expand works
</verification>

<success_criteria>
- IntegratedLayout imports both CatalogBrowser and FilterBreadcrumb from './catalog'
- FilterBreadcrumb renders below command bar
- CatalogBrowser renders in collapsible sidebar
- Clicking facets updates breadcrumb (proves FilterContext wiring works)
- `npm run typecheck` passes
</success_criteria>

<output>
After completion, create `.planning/phases/79-catalog-browser/79-04-SUMMARY.md`
</output>
