# Phase 105-02: Hook and Context

**Status:** COMPLETE
**Completed:** 2026-02-15

## Goal

Implement the core layout computation hook and context provider for theme and callbacks.

## Deliverables

### 1. hooks/useGridLayout.ts — Layout Computation Hook

**File:** `src/components/supergrid/hooks/useGridLayout.ts` (133 lines)

**Hook signature:**
```typescript
function useGridLayout(rowAxis: AxisConfig, colAxis: AxisConfig): GridLayout
```

**Returns:**
- `rowMetrics` — TreeMetrics for row axis
- `colMetrics` — TreeMetrics for column axis
- `gridTemplate` — { columns, rows } CSS Grid template strings
- `cornerCells` — CornerCellData[] for MiniNav area
- `rowHeaders` — HeaderCell[] with placements
- `colHeaders` — HeaderCell[] with placements
- `dataCells` — DataCellPosition[] for all cell coordinates
- `rowHeaderDepth` — Number of row header columns
- `colHeaderDepth` — Number of column header rows

**Memoization:** All computation wrapped in `useMemo([rowAxis, colAxis])`.

**Helper functions:**
```typescript
getCellKey(rowPath: string[], colPath: string[]): string
parseCellKey(key: string): { rowPath: string[]; colPath: string[] } | null
```

### 2. SuperGridCSSContext.tsx — Context Provider

**File:** `src/components/supergrid/SuperGridCSSContext.tsx` (167 lines)

**Theme definitions:**
```typescript
const themes: Record<SuperGridThemeName, SuperGridTheme> = {
  reference: { name: 'Reference Image', corner: '#00CED1', ... },
  nextstep: { name: 'NeXTSTEP', corner: '#AAAAAA', ... },
  modern: { name: 'Modern', corner: '#F1F5F9', ... },
  dark: { name: 'Dark', corner: '#1E293B', ... },
};
```

**Context value:**
```typescript
interface SuperGridContextValue {
  theme: SuperGridTheme;
  onCellClick?: (cell, rowPath, colPath) => void;
  selectedCell: { rowPath, colPath } | null;
  setSelectedCell: (cell) => void;
}
```

**Exports:**
- `themes` — Theme definitions
- `getTheme(name)` — Get theme by name
- `SuperGridCSSProvider` — Context provider component
- `useSuperGridContext()` — Hook to consume context

## Verification

- Hook computes correct layout for reference image data
- Context provides theme and selection state
- Memoization prevents unnecessary recomputation

## REQ-IDs Addressed

| REQ-ID | Requirement | Status |
|--------|-------------|--------|
| SG-CSS-04 | Implement useGridLayout hook | COMPLETE |
| SG-CSS-05 | Implement theme context provider | COMPLETE |
| SG-CSS-06 | Support 4 themes (reference, nextstep, modern, dark) | COMPLETE |
