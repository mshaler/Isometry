---
phase: 32-multi-environment-debugging
plan: 07
type: execute
wave: 2
depends_on: ["32-06"]
files_modified: [
  "src/utils/d3-optimization.ts",
  "src/components/settings/NotesIntegrationSettings.tsx",
  "src/components/shared/ConnectionStatus.tsx",
  "src/components/shell/Terminal.tsx",
  "src/components/SuperGridView.tsx",
  "src/components/sync/SyncStatusIndicator.tsx"
]
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "TypeScript compilation completes with zero errors"
    - "All unused variables and imports are removed or prefixed with underscore"
    - "Generic type errors in d3-optimization.ts are resolved"
  artifacts:
    - path: "src/utils/d3-optimization.ts"
      provides: "Type-safe D3 optimization utilities"
      min_lines: 50
    - path: "src/components/settings/NotesIntegrationSettings.tsx"
      provides: "Clean component without unused variables"
      min_lines: 200
  key_links:
    - from: "src/components/settings/NotesIntegrationSettings.tsx"
      to: "function variable scoping"
      via: "proper variable declaration order"
      pattern: "const.*loadPermissionStatus"
---

<objective>
Complete TypeScript compilation gap closure by eliminating remaining errors: fix generic type errors in d3-optimization.ts, resolve variable scoping issues, and clean up unused imports across all components.

Purpose: Achieve clean TypeScript compilation environment for stable development workflow
Output: Zero TypeScript compilation errors across the entire codebase
</objective>

<execution_context>
@/Users/mshaler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mshaler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/32-multi-environment-debugging/32-06-SUMMARY.md
@.planning/phases/32-multi-environment-debugging/32-VERIFICATION.md

# Gap context: After fixing core interface issues, remaining errors are:
# - Generic type errors in d3-optimization.ts with implicit any types
# - Variable declaration order issues in NotesIntegrationSettings.tsx
# - Unused imports and variables throughout multiple components
</context>

<tasks>

<task type="auto">
  <name>Fix generic type errors and implicit any types in d3-optimization.ts</name>
  <files>src/utils/d3-optimization.ts</files>
  <action>
    Fix all TypeScript generic type errors and implicit any types in the D3 optimization utility file.

    Common fixes needed:
    - Add explicit type parameters to generic functions: `<T>()` instead of `()`
    - Replace implicit any types with proper type annotations
    - Fix D3 selection type annotations: `d3.Selection<SVGElement, T, null, undefined>`
    - Add type guards for data transformations
    - Ensure all function parameters and returns are properly typed

    Focus on maintaining functionality while adding type safety. Use D3 v7 type definitions.

    Gap reason: Multiple TypeScript generic type errors preventing compilation
    Reference existing code: D3 Canvas component for proper D3 TypeScript patterns
  </action>
  <verify>npx tsc --noEmit src/utils/d3-optimization.ts</verify>
  <done>d3-optimization.ts compiles without type errors</done>
</task>

<task type="auto">
  <name>Fix variable scoping and declaration order issues</name>
  <files>src/components/settings/NotesIntegrationSettings.tsx</files>
  <action>
    Fix variable scoping and declaration order issues in NotesIntegrationSettings component:

    Main issues to fix:
    - Move loadPermissionStatus, loadLiveSyncStatus, loadStatistics function declarations before their usage in useEffect
    - Remove unused 'subscriptions' variable or prefix with underscore if needed for debugging
    - Ensure all variables are declared before being used
    - Fix block-scoped variable order issues

    Maintain existing functionality while ensuring proper TypeScript compilation.

    Gap reason: Block-scoped variables used before declaration causing compilation errors
    Reference existing code: Proper useCallback and useEffect patterns in other components
  </action>
  <verify>npx tsc --noEmit src/components/settings/NotesIntegrationSettings.tsx</verify>
  <done>NotesIntegrationSettings.tsx compiles without scoping errors</done>
</task>

<task type="auto">
  <name>Clean up unused imports and variables across components</name>
  <files>src/components/shared/ConnectionStatus.tsx, src/components/shell/Terminal.tsx, src/components/SuperGridView.tsx, src/components/sync/SyncStatusIndicator.tsx</files>
  <action>
    Systematically clean up unused imports and variables across multiple components:

    For each file, fix these common issues:
    - Remove unused React import if only types are used
    - Remove unused imported functions and components
    - Prefix unused parameters with underscore (_param) if needed for future use
    - Remove unused destructured variables from hooks and contexts
    - Remove unused local variables and functions

    Focus on the specific errors reported by TypeScript compiler:
    - ConnectionStatus.tsx: unused React import, testConnection, lastStatusChange, theme
    - Terminal.tsx: unused useTerminalContext import, setWorkingDirectory, executeTerminalCommand, writeTerminalOutput
    - SuperGridView.tsx: unused useRef import, zoomLevel, setOriginPattern
    - SyncStatusIndicator.tsx: unused selectedConflict

    Gap reason: TS6133 errors for unused variables preventing clean compilation
    Reference existing code: Clean import patterns in recently fixed components
  </action>
  <verify>npx tsc --noEmit src/components/shared/ConnectionStatus.tsx src/components/shell/Terminal.tsx src/components/SuperGridView.tsx src/components/sync/SyncStatusIndicator.tsx</verify>
  <done>All specified component files compile without unused variable warnings</done>
</task>

</tasks>

<verification>
1. npx tsc --noEmit runs without any errors
2. d3-optimization.ts has proper TypeScript types throughout
3. NotesIntegrationSettings.tsx has proper variable scoping
4. All components have clean imports without unused variables
</verification>

<success_criteria>
- Zero TypeScript compilation errors across entire codebase
- All generic types properly annotated in d3-optimization.ts
- Proper variable declaration order in all components
- No unused imports or variables (or properly prefixed with underscore)
</success_criteria>

<output>
After completion, create `.planning/phases/32-multi-environment-debugging/32-07-SUMMARY.md`
</output>