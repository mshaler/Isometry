---
phase: 32-multi-environment-debugging
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [
  "native/Sources/Isometry/Verification/DataVerificationPipeline.swift",
  "native/Sources/Isometry/Views/Sync/ConflictResolutionView.swift",
  "native/Sources/Isometry/Sync/CloudKitSyncManager.swift",
  "native/Sources/Isometry/Storage/ContentAwareStorageManager.swift"
]
autonomous: true

must_haves:
  truths:
    - "Swift project compiles without errors"
    - "Native iOS/macOS app can be built successfully"
    - "All type conflicts are resolved"
  artifacts:
    - path: "native/Sources/Isometry/Verification/DataVerificationPipeline.swift"
      provides: "Compilation without type conflicts"
      min_lines: 800
    - path: "native/Sources/Isometry/Views/Sync/ConflictResolutionView.swift"
      provides: "Proper CloudKitSyncManager types"
      min_lines: 50
    - path: "native/Sources/Isometry/Sync/CloudKitSyncManager.swift"
      provides: "ConflictResolution enum definition"
      min_lines: 500
  key_links:
    - from: "ConflictResolutionView.swift"
      to: "CloudKitSyncManager.swift"
      via: "ConflictResolution type reference"
      pattern: "CloudKitSyncManager\\.ConflictResolution"
    - from: "DataVerificationPipeline.swift"
      to: "Swift standard types"
      via: "unique type names"
      pattern: "struct.*VerificationResult"
---

<objective>
Fix critical Swift compilation errors that prevent native iOS/macOS app builds

Purpose: Resolve type conflicts, missing types, and redeclarations blocking Swift compilation
Output: Clean Swift build without compilation errors
</objective>

<execution_context>
@/Users/mshaler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mshaler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Resolve type redeclaration conflicts in DataVerificationPipeline</name>
  <files>native/Sources/Isometry/Verification/DataVerificationPipeline.swift</files>
  <action>
    Fix the type redeclaration errors by:
    1. Remove duplicate VerificationResult struct (lines 755-763) - use existing one from CloudKitProductionVerifier
    2. Remove duplicate DataSource struct (lines 786-790) - use existing enum version
    3. Remove duplicate chunked(into:) extension (lines 903-907) - use Swift standard library version
    4. Fix verificationResults property to use correct VerificationResult type
    5. Update all method signatures to use consistent types from CloudKitProductionVerifier
    6. Fix dictionary subscription syntax errors by ensuring correct key-value types

    The goal is to use the existing types from CloudKitProductionVerifier.swift and maintain compatibility with the verification pipeline.
  </action>
  <verify>cd native && swift build 2>&1 | grep -c "DataVerificationPipeline.swift.*error" | test $(cat) -eq 0</verify>
  <done>DataVerificationPipeline.swift compiles without redeclaration or type errors</done>
</task>

<task type="auto">
  <name>Task 2: Fix missing ConflictResolution type in CloudKitSyncManager</name>
  <files>native/Sources/Isometry/Sync/CloudKitSyncManager.swift</files>
  <action>
    Add the missing ConflictResolution enum to CloudKitSyncManager:
    1. Define ConflictResolution enum with cases: .useLocal, .useRemote, .merge, .askUser
    2. Ensure the enum is public and accessible from ConflictResolutionView
    3. Add any required associated values for conflict resolution data
    4. Verify compatibility with existing conflict resolution code patterns

    Place the enum definition near other type definitions in the CloudKitSyncManager actor.
  </action>
  <verify>cd native && swift build 2>&1 | grep -c "ConflictResolution.*not a member" | test $(cat) -eq 0</verify>
  <done>ConflictResolutionView can access CloudKitSyncManager.ConflictResolution type</done>
</task>

<task type="auto">
  <name>Task 3: Fix ContentAwareStorageManager initialization errors</name>
  <files>native/Sources/Isometry/Storage/ContentAwareStorageManager.swift</files>
  <action>
    Fix missing basePath parameter errors by:
    1. Review ContentAwareStorageManager.init signature to understand required parameters
    2. Find all locations where basePath parameter is missing in initialization calls
    3. Provide appropriate default basePath values (likely Documents or Application Support directory)
    4. Update initialization calls in:
       - DatabaseVersionControlView.swift (line 1028)
       - ETLDataCatalogView.swift (line 25)
       - ETLWorkflowView.swift (line 18)
    5. Ensure basePath URLs are valid and accessible within app sandbox

    Use FileManager.default.urls(for: .applicationSupportDirectory, in: .userDomainMask) for default paths.
  </action>
  <verify>cd native && swift build 2>&1 | grep -c "missing argument.*basePath" | test $(cat) -eq 0</verify>
  <done>All ContentAwareStorageManager initializations have required basePath parameter</done>
</task>

</tasks>

<verification>
Run: cd native && swift build
- All compilation errors resolved
- No type redeclaration warnings
- Clean build output
</verification>

<success_criteria>
- Swift project builds without errors
- All type conflicts resolved
- Native app can proceed to next development phase
- No remaining compilation blockers
</success_criteria>

<output>
After completion, create `.planning/phases/32-multi-environment-debugging/32-01-SUMMARY.md`
</output>