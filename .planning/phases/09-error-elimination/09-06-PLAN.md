---
phase: 09-error-elimination
plan: 06
type: execute
wave: 1
depends_on: ["09-05"]
files_modified: [
  "src/server/launch-native-server.js",
  "src/hooks/useD3.ts",
  "src/utils/sql-to-grdb.ts",
  "src/utils/webview-bridge.ts",
  "src/utils/officeDocumentProcessor.ts",
  "src/db/PerformanceMonitor.ts",
  "src/db/QueryTranslation.ts",
  "src/db/WebViewDatabaseContext.tsx",
  "src/components/views/NetworkView.tsx",
  "src/App.tsx",
  "eslint.config.js"
]
autonomous: true

must_haves:
  truths:
    - "npm run lint returns 'No problems found!'"
    - "All 47 lint errors completely eliminated"
    - "All 213 lint warnings completely eliminated"
    - "ESLint config properly handles Node.js globals"
    - "TypeScript no-explicit-any warnings resolved systematically"
  artifacts:
    - path: "eslint.config.js"
      provides: "Fixed Node.js global configuration"
      contains: "globals: { console: 'readonly', process: 'readonly' }"
    - path: "src/server/launch-native-server.js"
      provides: "Fixed eslint-env comment and Node globals"
      contains: "/* global console, process */"
    - path: "src/utils/webview-bridge.ts"
      provides: "Complete type safety for bridge interfaces"
      min_lines: 500
      exports: ["WebViewBridge", "BridgeMessage"]
    - path: "src/utils/officeDocumentProcessor.ts"
      provides: "Proper types for document parsing APIs"
      contains: "DocumentParsingResult"
  key_links:
    - from: "eslint.config.js"
      to: "Node.js globals"
      via: "globals configuration"
      pattern: "globals.*console.*process"
    - from: "src/utils/webview-bridge.ts"
      to: "TypeScript interfaces"
      via: "no any types"
      pattern: "interface.*(?!any)"
---

<objective>
Achieve absolute zero lint problems (260 → 0) through comprehensive error elimination, proper type definitions, and ESLint configuration fixes.

Purpose: Complete the lint cleanup journey to production-ready code quality with zero errors and warnings, enabling clean builds and enhanced type safety across the entire codebase.
Output: Codebase with exactly 0 lint problems, comprehensive type safety, and proper configuration for all environments.
</objective>

<execution_context>
@/Users/mshaler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mshaler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-error-elimination/09-05-SUMMARY.md

# Current lint status: 260 problems (47 errors, 213 warnings)
# Major categories: no-explicit-any (110), no-unused-vars (103), no-undef (34)
# Critical areas: WebView bridge, Office processor, Node.js server, ESLint config
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix ESLint configuration and Node.js global errors</name>
  <files>eslint.config.js, src/server/launch-native-server.js</files>
  <action>
    Fix the 34 no-undef errors by properly configuring Node.js globals in ESLint:

    1. **Update eslint.config.js:**
       - Add Node.js globals configuration: `globals: { console: 'readonly', process: 'readonly', Buffer: 'readonly', __dirname: 'readonly', __filename: 'readonly' }`
       - Configure environment for Node.js files specifically
       - Ensure flat config compatibility

    2. **Fix src/server/launch-native-server.js:**
       - Replace `/* eslint-env node */` with `/* global console, process */` comment
       - Verify all process and console usage is properly recognized

    This eliminates the 34 no-undef errors and the ESLint flat config warning.

    Reference existing approach: Previous phases used strategic underscore prefixes for unused vars, maintaining similar systematic approach.
  </action>
  <verify>npm run lint 2>&1 | grep "no-undef" | wc -l should return 0, and ESLintEnvWarning should not appear</verify>
  <done>All Node.js global variable errors eliminated, ESLint properly configured for all file types</done>
</task>

<task type="auto">
  <name>Task 2: Eliminate all remaining unused variable warnings</name>
  <files>src/db/PerformanceMonitor.ts, src/db/QueryTranslation.ts, src/components/views/NetworkView.tsx, src/App.tsx</files>
  <action>
    Systematically fix the remaining 103 no-unused-vars warnings using established patterns from 09-05:

    1. **src/db/PerformanceMonitor.ts:**
       - Line 152: `successfulOperations` → `_successfulOperations` or remove if truly unused
       - Line 357: `testData` → `_testData` or integrate into test logic

    2. **src/db/QueryTranslation.ts:**
       - Line 122: `complexityScore` → `_complexityScore` or integrate into metrics
       - Line 300: `params` → `_params` (already follows pattern, ensure consistency)

    3. **src/components/views/NetworkView.tsx:**
       - Line 10: `D3SVGSelection` → `_D3SVGSelection` or remove unused import

    4. **src/App.tsx:**
       - Line 12: `_AppContent` already prefixed, verify still triggering warning

    Apply the systematic approach from 09-05: underscore prefix for required parameters, complete removal for unused locals, maintain functionality.
  </action>
  <verify>npm run lint 2>&1 | grep "no-unused-vars" | wc -l should return 0</verify>
  <done>Zero unused variable warnings across entire codebase with proper parameter naming conventions</done>
</task>

<task type="auto">
  <name>Task 3: Comprehensive WebView bridge type safety implementation</name>
  <files>src/utils/webview-bridge.ts, src/db/WebViewDatabaseContext.tsx</files>
  <action>
    Replace all 'any' types in WebView bridge with comprehensive TypeScript interfaces, building on 09-05 architectural foundation:

    1. **Define complete bridge message interfaces:**
       ```typescript
       interface BridgeMessage<T = unknown> {
         id: string;
         type: string;
         payload: T;
         timestamp?: number;
       }

       interface DatabaseQueryMessage {
         operation: 'SELECT' | 'INSERT' | 'UPDATE' | 'DELETE';
         sql: string;
         params: unknown[];
       }

       interface FileSystemMessage {
         operation: 'read' | 'write' | 'delete';
         path: string;
         content?: string;
       }
       ```

    2. **Replace all 50+ 'any' types with proper interfaces:**
       - Message handlers: BridgeMessage<DatabaseQueryMessage>
       - Callback types: (result: DatabaseResult) => void
       - Error handling: (error: BridgeError) => void
       - Response types: Promise<BridgeResponse<T>>

    3. **Update WebViewDatabaseContext.tsx:**
       - Replace 'any' on line 24 with proper DatabaseContextType
       - Ensure all bridge calls use typed interfaces

    Strategic approach: Maintain backward compatibility while eliminating all 'any' usage through comprehensive interface design.
  </action>
  <verify>npm run lint src/utils/webview-bridge.ts src/db/WebViewDatabaseContext.tsx 2>&1 | grep "no-explicit-any" | wc -l should return 0</verify>
  <done>WebView bridge completely type-safe with zero 'any' types and comprehensive interface coverage</done>
</task>

<task type="auto">
  <name>Task 4: Office document processor type safety and final cleanup</name>
  <files>src/utils/officeDocumentProcessor.ts, src/hooks/useD3.ts, src/utils/sql-to-grdb.ts</files>
  <action>
    Complete type safety for remaining complex systems and eliminate final lint issues:

    1. **Office Document Processor:**
       - Replace 'any' types with specific Office API interfaces
       - Create DocumentParsingResult interface for return types
       - Add proper error types for document processing failures
       - Handle dynamic content types with union types instead of 'any'

    2. **D3 Hook Type Safety:**
       - Replace any D3-related 'any' types with proper D3.Selection types
       - Ensure SVG element types are properly typed
       - Add generic constraints for D3 data binding

    3. **SQL Translation Module:**
       - Fix any remaining case-declaration block issues
       - Ensure all GRDB translation types are properly defined
       - Remove any lingering 'any' types in query handling

    4. **Final sweep for missed issues:**
       - Check for any no-case-declarations errors
       - Verify all regex patterns properly escaped
       - Clean up any remaining import/export issues

    This completes the comprehensive type safety implementation across all major systems.
  </action>
  <verify>npm run lint 2>&1 | tail -1 should show "✖ 0 problems"</verify>
  <done>Complete codebase achieves exactly zero lint problems with comprehensive type safety and clean configuration</done>
</task>

</tasks>

<verification>
Comprehensive lint elimination validation:

1. **Zero Problems Achieved:**
   ```bash
   npm run lint
   # Expected output: "✖ 0 problems"
   ```

2. **Test Suite Integrity:**
   ```bash
   npm run test
   # Expected: 471 tests passing (no regressions)
   ```

3. **Type Check Success:**
   ```bash
   npm run typecheck
   # Expected: Zero TypeScript errors
   ```

4. **Build Success:**
   ```bash
   npm run build
   # Expected: Clean build with no warnings
   ```

5. **Category-Specific Verification:**
   ```bash
   npm run lint 2>&1 | grep "no-explicit-any" | wc -l    # Should be 0
   npm run lint 2>&1 | grep "no-unused-vars" | wc -l     # Should be 0
   npm run lint 2>&1 | grep "no-undef" | wc -l           # Should be 0
   npm run lint 2>&1 | grep "error" | wc -l              # Should be 0
   npm run lint 2>&1 | grep "warning" | wc -l            # Should be 0
   ```
</verification>

<success_criteria>
**Primary Success Criteria:**
1. **Absolute Zero Lint Problems:** `npm run lint` reports "✖ 0 problems"
2. **Complete Error Elimination:** All 47 errors resolved with proper configuration
3. **Complete Warning Elimination:** All 213 warnings resolved with type safety
4. **Comprehensive Type Safety:** Zero 'any' types in production code paths
5. **Maintained Functionality:** All 471 tests continue passing

**Quality Metrics:**
- **Before:** 260 problems (47 errors, 213 warnings)
- **After:** 0 problems (0 errors, 0 warnings)
- **Type Safety:** 110 no-explicit-any → 0 with proper interfaces
- **Code Cleanliness:** 103 no-unused-vars → 0 with systematic patterns
- **Configuration:** Node.js globals properly configured in ESLint

**Production Readiness:**
- ESLint configuration supports all environments (browser, Node.js, TypeScript)
- WebView bridge fully type-safe for secure communication
- Office document processing with comprehensive error handling
- Zero build warnings enabling App Store submission
</success_criteria>

<output>
After completion, create `.planning/phases/09-error-elimination/09-06-SUMMARY.md` documenting the achievement of zero lint problems and comprehensive type safety implementation.
</output>