---
phase: 09-error-elimination
plan: 04
type: execute
wave: 3
depends_on: ["09-03"]
files_modified: [
  "native/Sources/Isometry/ETL/ETLOperationManager.swift",
  "native/Sources/Isometry/ETL/ETLVersionControlIntegration.swift",
  "native/Package.swift"
]
autonomous: true

must_haves:
  truths:
    - "Swift builds without actor isolation warnings"
    - "Sendable conformance properly implemented"
    - "Actor boundary issues resolved"
  artifacts:
    - path: "native/Sources/Isometry/ETL/ETLOperationManager.swift"
      provides: "Sendable-compliant ETL operations"
      contains: "Sendable"
    - path: "native/Sources/Isometry/ETL/ETLVersionControlIntegration.swift"
      provides: "Fixed actor isolation warnings"
      contains: "@MainActor"
  key_links:
    - from: "ETLOperationResult"
      to: "Sendable protocol"
      via: "conformance declaration"
      pattern: "ETLOperationResult.*Sendable"
    - from: "actor methods"
      to: "MainActor isolation"
      via: "@MainActor annotations"
      pattern: "@MainActor.*func"
---

<objective>
Resolve Swift actor isolation warnings and Sendable conformance issues in the native codebase.

Purpose: Eliminate Swift build warnings and ensure proper concurrency safety for production deployment.
Output: Clean Swift build with zero actor isolation warnings and proper Sendable conformance.
</objective>

<execution_context>
@/Users/mshaler/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mshaler/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Fix Sendable conformance for ETL types</name>
  <files>
    native/Sources/Isometry/ETL/ETLOperationManager.swift
  </files>
  <action>
    Add Sendable conformance to resolve actor isolation warnings:

    1. Make ETLOperationResult conform to Sendable:
    - Add `: Sendable` to struct declaration
    - Ensure all stored properties are Sendable-safe
    - If any properties can't be Sendable, use @unchecked Sendable with documentation

    2. Review ETLOperation and related types:
    - Add Sendable conformance where appropriate
    - Use @unchecked Sendable for types that are conceptually thread-safe but can't prove it
    - Add proper documentation for concurrency safety

    3. Update operation manager methods:
    - Ensure async methods properly handle Sendable requirements
    - Add actor isolation annotations where needed

    Focus on making the build warnings disappear while maintaining thread safety.
  </action>
  <verify>swift build shows no Sendable conformance warnings for ETL types</verify>
  <done>ETL types properly conform to Sendable protocol</done>
</task>

<task type="auto">
  <name>Resolve actor isolation warnings in version control integration</name>
  <files>
    native/Sources/Isometry/ETL/ETLVersionControlIntegration.swift
  </files>
  <action>
    Fix actor isolation warnings for version control operations:

    1. Review ETLVersionControlResult and AnalyticsETLResult:
    - Ensure proper Sendable conformance for stored properties
    - Add @unchecked Sendable if needed with safety documentation
    - Make sure baseResult/etlResult properties are thread-safe

    2. Add proper MainActor isolation:
    - Use @MainActor for UI-related operations
    - Use isolated parameters for actor-bound operations
    - Ensure proper actor boundary handling

    3. Update async/await patterns:
    - Ensure proper isolation for cross-actor calls
    - Add sendable compliance for closure parameters
    - Use Task detached isolation where appropriate

    Target the specific warnings shown in the build output.
  </action>
  <verify>swift build shows no actor isolation warnings in version control files</verify>
  <done>Actor isolation properly configured for version control operations</done>
</task>

<task type="auto">
  <name>Update Package.swift configuration for Swift 6 compliance</name>
  <files>
    native/Package.swift
  </files>
  <action>
    Update Swift package configuration for proper concurrency handling:

    1. Ensure Swift version is properly specified:
    - Set minimum Swift version to support actor isolation
    - Configure proper platform versions

    2. Add concurrency settings if needed:
    - Enable strict concurrency checking if beneficial
    - Configure proper compiler flags for Sendable warnings

    3. Review target configuration:
    - Ensure proper dependency management
    - Add any necessary compiler settings for actor isolation

    This should be a minimal change to ensure package configuration supports the concurrency fixes.
  </action>
  <verify>swift build completes without package configuration warnings</verify>
  <done>Package configuration supports proper concurrency handling</done>
</task>

</tasks>

<verification>
- swift build should complete with zero actor isolation warnings
- No Sendable conformance warnings in build output
- Native package builds successfully for all targets
</verification>

<success_criteria>
- Zero Swift actor isolation warnings
- Proper Sendable conformance for all ETL types
- Clean Swift build with full concurrency safety
- Production-ready native codebase
</success_criteria>

<output>
After completion, create `.planning/phases/09-error-elimination/09-04-SUMMARY.md`
</output>